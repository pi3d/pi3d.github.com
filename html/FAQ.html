<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Frequently Asked Questions &#8212; pi3d 2.21 documentation</title>
    
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '2.21',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="top" title="pi3d 2.21 documentation" href="index.html" />
    <link rel="next" title="3D Graphics Explanation" href="GPUexplain.html" />
    <link rel="prev" title="Introduction to pi3d" href="ReadMe.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="GPUexplain.html" title="3D Graphics Explanation"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="ReadMe.html" title="Introduction to pi3d"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">pi3d 2.21 documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="frequently-asked-questions">
<h1>Frequently Asked Questions<a class="headerlink" href="#frequently-asked-questions" title="Permalink to this headline">¶</a></h1>
<div class="section" id="graphics-memory">
<h2>Graphics Memory<a class="headerlink" href="#graphics-memory" title="Permalink to this headline">¶</a></h2>
<div class="section" id="assert-s-0">
<h3>assert s &gt;= 0<a class="headerlink" href="#assert-s-0" title="Permalink to this headline">¶</a></h3>
<p>When starting any demo I get an AssertionError in DisplayOpenGL
<code class="docutils literal"><span class="pre">assert</span> <span class="pre">s</span> <span class="pre">&gt;=</span> <span class="pre">0</span></code></p>
<blockquote>
<div>This is generally caused by the graphics memory allocation on the
Raspberry Pi being too low (less than 32)</div></blockquote>
</div>
<div class="section" id="egl-no-surface">
<h3>EGL_NO_SURFACE<a class="headerlink" href="#egl-no-surface" title="Permalink to this headline">¶</a></h3>
<p>When starting any demo I get an AssertionError in DisplayOpenGL
<code class="docutils literal"><span class="pre">assert</span> <span class="pre">self.surface</span> <span class="pre">!=</span> <span class="pre">EGL_NO_SURFACE</span></code></p>
<blockquote>
<div>This is generally caused by the graphics memory allocation on the
Raspberry Pi being too low (less than 64) It has also been caused
by extra shared libraries such as <code class="docutils literal"><span class="pre">/usr/lib/arm-linux-gnueabihf/libEGL.so.1</span></code>
and symbolic links being added by other programs see five questions
below...</div></blockquote>
</div>
<div class="section" id="start-then-shut-down">
<h3>Start then shut down<a class="headerlink" href="#start-then-shut-down" title="Permalink to this headline">¶</a></h3>
<p>When running ConferenceHall (or other program with a large number of
textures) it appears to start ok then shuts down (byebye 3 message) just
before the main display loop should appear.</p>
<blockquote>
<div>This is generally caused by the graphics memory allocation on the
Raspberry Pi being too low (less than 128)</div></blockquote>
<p>Is there a way of using memory more efficiently when using large
images?</p>
<blockquote>
<div><p>There are two features added to the Texture class from v2.9 The first
allows &#8216;normal&#8217; CPU memory to be released after the GPU texture sampler
has been created: use the argument <code class="docutils literal"><span class="pre">pi3d.Texture(free_after_load=True)</span></code></p>
<p>The second feature allows more highly compressed texture formats to be
used for the GPU storage. The default is GL_RGB or GL_RGBA for jpg or
png style textures respectively which take three or four bytes. pi3d.GL_RGBA4,
pi3d.GL_RGB5_A1, pi3d.GL_RGB565 are alternatives that use only two bytes
and give quite acceptable colours for most things. Use for instance
<code class="docutils literal"><span class="pre">pi3d.Texture(i_format=pi3d.GL_RGB565)</span></code></p>
</div></blockquote>
</div>
</div>
<div class="section" id="tkinter-tclerror">
<h2>_tkinter.TclError<a class="headerlink" href="#tkinter-tclerror" title="Permalink to this headline">¶</a></h2>
<p>When starting TigerTank, ConferenceHall or MarsStation demos I get an
error <code class="docutils literal"><span class="pre">_tkinter.TclError:</span> <span class="pre">couldn't</span> <span class="pre">connect</span> <span class="pre">to</span> <span class="pre">display</span> <span class="pre">&quot;:0&quot;</span></code></p>
<blockquote>
<div>tkinter is trying to use a display provided by the X-server. Run
startx from the command line.</div></blockquote>
</div>
<div class="section" id="pistore-install">
<h2>PiStore install<a class="headerlink" href="#pistore-install" title="Permalink to this headline">¶</a></h2>
<div class="section" id="taking-too-long">
<h3>taking too long<a class="headerlink" href="#taking-too-long" title="Permalink to this headline">¶</a></h3>
<p>I am trying to install using PiStore but it&#8217;s been running for hours
with no sign of completing.</p>
<blockquote>
<div>The PiStore install adds <cite>pip</cite> and <cite>Pillow</cite> which take quite a bit
of the cpu resources. It could be that you have set the graphics memory share
to the higher level needed to run pi3d. In the long run it will be quicker
to abort the installation, remove the half installed pi3d, use
raspi-config to set the graphics memory low, re-install pi3d, then
set the graphics memory back up again!</div></blockquote>
</div>
<div class="section" id="doing-more-with-pistore-installation">
<h3>Doing more with PiStore installation<a class="headerlink" href="#doing-more-with-pistore-installation" title="Permalink to this headline">¶</a></h3>
<p>I have installed using PiStore and run the demos from the Menu. Now
I would like to play around for myself.</p>
<blockquote>
<div><p>There is a PiStore button next to <cite>launch</cite> that lets you see the source
code. It should open a file browser window to
<cite>/usr/local/indiecity/InstalledApps/skillmanmedia/Full/pi3d_demos</cite>
which is a very obscure location and also protected against modification.
To play around with the code you should either copy the whole
of this directory to your home directory (i.e. so you have
<cite>/home/pi/pi3d_demos/</cite>) or clone or download the demos from
<a class="reference external" href="http://github.com/pi3d/pi3d_demos">http://github.com/pi3d/pi3d_demos</a> (which will include a couple of
other demos excluded from PiStore because they use very large resource
files.)</p>
<p>Before going too far it would be a good idea to <a class="reference external" href="http://pi3d.github.com/html/index.html">ReadMe</a></p>
</div></blockquote>
</div>
</div>
<div class="section" id="glx-dri2-not-supported-or-failed-to-authenticate">
<h2>GLX DRI2 not supported or failed to authenticate<a class="headerlink" href="#glx-dri2-not-supported-or-failed-to-authenticate" title="Permalink to this headline">¶</a></h2>
<p>When I try and run the demos I just get a load of error messages such as
<code class="docutils literal"><span class="pre">libEGL</span> <span class="pre">warning:</span> <span class="pre">GLX/DRI2</span> <span class="pre">is</span> <span class="pre">not</span> <span class="pre">supported/failed</span> <span class="pre">to</span> <span class="pre">authenticate</span> <span class="pre">etc</span></code></p>
<blockquote>
<div><p>The chances are this is because &#8216;something&#8217; (such as gedit) has installed
mesa which added its own versions of libEGL and libGLESv2. If
you run:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ sudo find / -name libEGL*
$ sudo find / -name libGLESv2*
</pre></div>
</div>
<p><strong>on the Raspberry Pi</strong> you should just get /opt/vc/lib/libEGL.so
and /opt/vc/lib/libGLESv2.so if other ones turn up i.e.
/usr/lib/arm-linux-gnueabihf/libEGL.so.1 you could try creating symbolic
links for them all like this:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ sudo ln -fs /opt/vc/lib/libEGL.so /usr/lib/arm-linux-gnueabihf/libEGL.so
$ sudo ln -fs /opt/vc/lib/libEGL.so /usr/lib/arm-linux-gnueabihf/libEGL.so.1
$ sudo ln -fs /opt/vc/lib/libGLESv2.so /usr/lib/arm-linux-gnueabihf/libGLESv2.so
$ sudo ln -fs /opt/vc/lib/libGLESv2.so /usr/lib/arm-linux-gnueabihf/libGLESv2.so.2
</pre></div>
</div>
<p><strong>NB on other systems such as Debian, ubuntu etc the &#8220;good&#8221; files
will not be in this location, they will be somewhere like
/usr/lib/x86_64-linux-gnu/mesa-egl/ so you have to alter the commands
accordingly</strong> Use the actual paths as listed by find. After creating new
symbolic links you will need to run:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ sudo ldconfig
</pre></div>
</div>
<p>This issue is being looked into by the maintainers of Raspbian so,
hopefully, it will be fixed in later releases.</p>
</div></blockquote>
</div>
<div class="section" id="runtime-errors">
<h2>Runtime errors<a class="headerlink" href="#runtime-errors" title="Permalink to this headline">¶</a></h2>
<div class="section" id="crashing">
<h3>Crashing<a class="headerlink" href="#crashing" title="Permalink to this headline">¶</a></h3>
<p>My RPi Crashes or reboots when I try and run a demo.</p>
<blockquote>
<div><p>Any program using a loadable texture, which includes nearly all the demos,
requires the Python Imaging module (PIL). Additionally, some demos require tk.</p>
<p>See the <a class="reference external" href="http://pi3d.github.com/html/index.html">ReadMe</a> for information on how to install these packages.</p>
</div></blockquote>
</div>
<div class="section" id="white-screen">
<h3>white screen<a class="headerlink" href="#white-screen" title="Permalink to this headline">¶</a></h3>
<p>I see nothing but a white screen.</p>
<blockquote>
<div><p>Possibly something has gone wrong with an opengles function, sometimes
there might be an error message in the terminal such as failed to create
display. This could be caused by running out of gpu memory (see <a class="reference external" href="http://pi3d.github.com/html/index.html">ReadMe</a>
for how to set up memory split).</p>
<p>Occasionally multi-threaded applications can cause this problem if an
opengles function call is made not from the main thread.  If you encounter
this, please contact the pi3d team so we can protect against this in
future.</p>
</div></blockquote>
</div>
<div class="section" id="black-screen">
<h3>black screen<a class="headerlink" href="#black-screen" title="Permalink to this headline">¶</a></h3>
<p>I see nothing but a black screen.</p>
<blockquote>
<div><p>This can be caused by running out of GPU memory, especially if it&#8217;s set
to 64 in which case some things will work fine then stop after the addition
of just one seemingly insignifican component. From v2.20 there will
be a Logger message to this effect. See below for questions using pi3d.Log</p>
<p>Possibly something has gone wrong in a shader, such as using a shader
requiring texture coords (i.e. mat_relfect) on a Model exported with
no uv mapping.</p>
<p>There may be a line number reference output by the shader compiler in the
terminal window.  It is great fun experimenting with shaders but they are
<em>?£#%</em> taciturn beasts to debug! The problem could be caused by sending
some bad render setting to a shader.</p>
</div></blockquote>
</div>
<div class="section" id="only-background">
<h3>only background<a class="headerlink" href="#only-background" title="Permalink to this headline">¶</a></h3>
<p>I see nothing but the background.</p>
<blockquote>
<div><p>You will need to set background to non-transparent and a color not equal
to black or white to determine if this is happening.</p>
<p>Either the shape is behind the camera, too far away, is outside the field
of view, is too small, too large or the polygons are facing away from the
camera. Often this is because you are actually <strong>inside</strong> the object.</p>
<p>Try using the Camera.point_at([x,y,z]) function (see demos/ClashWalk.py
for use) or move and rotate the object and camera. Sprite and ImageSprite
shapes are one sided so cannot be seen from behind, try using a Plane
instead</p>
<p>Prior to v2.9 of pi3d there was a bug that stopped shapes with very large
numbers of vertices rendering at all (c. 25000). Upgrade to a version post 2.9 to
see if this fixes the problem.</p>
</div></blockquote>
</div>
<div class="section" id="unlit-silhouettes">
<h3>unlit silhouettes<a class="headerlink" href="#unlit-silhouettes" title="Permalink to this headline">¶</a></h3>
<p>I see only black silhouettes against the background.</p>
<blockquote>
<div><p>You may be trying to use a shader that requires light but there isn&#8217;t
any, or it&#8217;s turned down too low. Try switching to a &#8216;flat&#8217; shader
to check.</p>
<p>Alternatively, if it&#8217;s a shape you have generated such as
a Lathe or a Model, the normal vectors might be pointing in the wrong
direction. Try re-generating the shape, the path you use for the Lathe
needs to start at the top of the object and there are functions in
most 3D modeling applications to recalculate normals, or force them
to point outwards.</p>
</div></blockquote>
</div>
<div class="section" id="mouse-not-working">
<h3>Mouse not working<a class="headerlink" href="#mouse-not-working" title="Permalink to this headline">¶</a></h3>
<p>The demo loads but the mouse doesn&#8217;t move the camera as it&#8217;s supposed to.</p>
<blockquote>
<div><p>If this only happens on demos using the <code class="docutils literal"><span class="pre">event</span></code> library (such as Silo.py)
then it could be the hardware configuration is pretending to be something
it isn&#8217;t. It&#8217;s not uncommon for keyboards to say they are mice or
joysticks.</p>
<p>If you have a mouse combined with a keyboard (to save on USB slots) then
you might need to use <code class="docutils literal"><span class="pre">get_mouse_movements(1)</span></code>. If you have problems
with a device or inputs using the event system it&#8217;s a good idea to run
<code class="docutils literal"><span class="pre">python</span> <span class="pre">FindDevices.py</span></code> from <code class="docutils literal"><span class="pre">pi3d/event/</span></code> - this will give you lots
of additional information.</p>
<p>There is also an application <code class="docutils literal"><span class="pre">demos/TestEvents.py</span></code> that you can run to
find what information is being returned by your input devices. In some
circumstances you might need to modify the values returned by the
<code class="docutils literal"><span class="pre">pi3d/event/Event.py</span> <span class="pre">InputEvents</span></code> methods. TODO at the moment this
involves hacking the file but it will use a lookup table.</p>
<p>When running on my laptop (lenovo T420, ubuntu 13.10), occasionally, the
mouse doesn&#8217;t work with the <code class="docutils literal"><span class="pre">event</span></code> input, but starts to do after
running <code class="docutils literal"><span class="pre">demos/TestEvents.py</span></code> and changing the number in
<code class="docutils literal"><span class="pre">get_mouse_movements()</span></code> a few times. It&#8217;s not clear what causes this
but it might be when the USB mouse is plugged in after the computer
has been booted up.</p>
<p>See also in the section <code class="docutils literal"><span class="pre">Permission</span> <span class="pre">denied</span></code> below</p>
</div></blockquote>
</div>
<div class="section" id="cbreak-error">
<h3>cbreak error<a class="headerlink" href="#cbreak-error" title="Permalink to this headline">¶</a></h3>
<p>When I try to run a demo I get an error ending <code class="docutils literal"><span class="pre">curses.cbreak()</span>
<span class="pre">error:</span> <span class="pre">cbreak()</span> <span class="pre">returned</span> <span class="pre">ERR</span></code></p>
<blockquote>
<div>The chances are that you are trying to run python directly from the
IDLE editor. Although IDLE works fine for most things, it seems to
have issues with the curses module that is used for keyboard input
and is incorporated in pi3d. Try running the demo from the command
line. Geany seems to run ok on the Raspberry pi and has python highlighting
and context suggestions.</div></blockquote>
</div>
<div class="section" id="scrambled-terminal-after-ctrl-c-or-crash">
<h3>scrambled terminal after Ctrl-C or crash<a class="headerlink" href="#scrambled-terminal-after-ctrl-c-or-crash" title="Permalink to this headline">¶</a></h3>
<p>With some of the demos the terminal seems to stop working after a break
out of the program. Sometimes typing doesn&#8217;t appear on the screen, sometimes
carriage return doesn&#8217;t work.</p>
<blockquote>
<div><p>This is due to curses being used for the keyboard input system. It needs
to do some tidying up by calling pi3d.Keyboard.close().</p>
<p>You can return the terminal to a normal state with <code class="docutils literal"><span class="pre">$</span> <span class="pre">stty</span> <span class="pre">sane</span></code> or
with <code class="docutils literal"><span class="pre">$</span> <span class="pre">reset</span></code>. A more complete solution that allows programs to be
stopped with Ctrl+c and the required closing down code still to run
would be a variation of:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">keys</span> <span class="o">=</span> <span class="n">pi3d</span><span class="o">.</span><span class="n">Keyboard</span><span class="p">()</span>
<span class="o">...</span>
<span class="k">try</span><span class="p">:</span>
  <span class="k">while</span> <span class="n">DISPLAY</span><span class="o">.</span><span class="n">loop_running</span><span class="p">():</span>
<span class="o">...</span>
    <span class="k">if</span> <span class="n">keys</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> <span class="o">==</span> <span class="mi">27</span><span class="p">:</span>
      <span class="k">break</span>

<span class="k">finally</span><span class="p">:</span> <span class="c1">#can also except KeyboardInterrup: for ctrl c specific things</span>
  <span class="n">keys</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="o">...</span>
</pre></div>
</div>
<p>alternatively from release
v2.15 onwards there is a KeyboardContext that can be used:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">KeyboardContext</span><span class="p">()</span> <span class="k">as</span> <span class="n">keys</span><span class="p">:</span>
  <span class="k">while</span> <span class="n">DISPLAY</span><span class="o">.</span><span class="n">loop_running</span><span class="p">():</span>
    <span class="n">sprite</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">keys</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> <span class="o">==</span> <span class="mi">27</span><span class="p">:</span>
      <span class="k">break</span>
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="no-video-output-running-remotely">
<h3>No video output running remotely<a class="headerlink" href="#no-video-output-running-remotely" title="Permalink to this headline">¶</a></h3>
<p>I am using the Raspberry Pi through a remote terminal with ssh or putty
but when I run pi3d applications there isn&#8217;t any video output. Well, when
I look at the screen connected to the Raspberry Pi I can see that the video
output is appearing there. How can I see it on a remote terminal?</p>
<blockquote>
<div><p>To pipe the images from the local display to a remote terminal requires
slightly specialist software and takes quite a bit of processing time. So
you won&#8217;t be able to see programs run full speed but you can do development
and testing.</p>
<p>An easy way is to install realvnc on the Raspberry Pi (it&#8217;s already there
in the latest raspbian but needs &#8216;activating&#8217;
<a class="reference external" href="https://www.realvnc.com/docs/raspberry-pi.html#raspberry-pi-setup">https://www.realvnc.com/docs/raspberry-pi.html#raspberry-pi-setup</a>)
and on the machine you want to connect from. There are explicit instructions
on the realvnc website. To get things working on my machine I had to reduce
the screen resolution quite a bit and enable the experimental direct capture mode.
The animation speed is significantly faster with the xserver desktop not
running and executing the pi3d programs from the command line. To do this
you will have to change the default behavior using raspi-config.</p>
</div></blockquote>
</div>
</div>
<div class="section" id="optional-arguments">
<h2>Optional arguments<a class="headerlink" href="#optional-arguments" title="Permalink to this headline">¶</a></h2>
<p>It appears from the demos that there are some arguments that are optional.
For example, can a Shape be drawn without specifying a shader and a texture?</p>
<blockquote>
<div><p>There are (almost too) many ways to set Shapes up to draw. The draw method
needs to have a <strong>Shader</strong>, a <strong>Light</strong> and a <strong>Camera</strong> specified but if
you neglect to create a Light and Camera when you first draw a Shape it
will generate &#8216;default instances&#8217; which most of the time are just what you
want. (These default instances can be accessed to change settings such as
color or direction for a Light or field of view for a Camera by using the
syntax: <code class="docutils literal"><span class="pre">Camera.instance()</span></code>.</p>
<p>However the default instance of Shader is <code class="docutils literal"><span class="pre">mat_light</span></code> which uses
the &#8216;self color&#8217; of the Shape (defaulting a neutral (0.5, 0.5, 0.5))
as it would be messy to try to figure out if or what Textures to use.
Generally you choose the Shader to do the kind of rendering you want,
but you can feed that in by various means, many of which also cater
for specifying the Texture(s) to use at the same time:</p>
<blockquote>
<div><p>Set them directly in the Buffer array - the other methods are
really just wrappers for this i.e.:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">myshape</span><span class="o">.</span><span class="n">buf</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shader</span> <span class="o">=</span> <span class="n">myshader</span>
<span class="n">myshape</span><span class="o">.</span><span class="n">buf</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">textures</span> <span class="o">=</span> <span class="p">[</span><span class="n">mytex</span><span class="p">,</span> <span class="n">normtex</span><span class="p">,</span> <span class="n">refltex</span><span class="p">]</span>
</pre></div>
</div>
<p>Include them
at draw time:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">myshape</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">myshader</span><span class="p">,</span> <span class="p">[</span><span class="n">mytex</span><span class="p">,</span> <span class="n">normtex</span><span class="p">,</span> <span class="n">refltex</span><span class="p">],</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
</pre></div>
</div>
<p>Set them beforehand
(probably the most usual way):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">myshape</span><span class="o">.</span><span class="n">set_draw_details</span><span class="p">(</span><span class="n">myshader</span><span class="p">,</span> <span class="p">[</span><span class="n">mytex</span><span class="p">,</span> <span class="n">normtex</span><span class="p">,</span> <span class="n">refltex</span><span class="p">],</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
</pre></div>
</div>
<p>For Model objects the ambient texture or material shade will normally
be defined in the 3D object file (egg or obj/mtl) In these cases
you could use:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">myshape</span><span class="o">.</span><span class="n">set_shader</span><span class="p">(</span><span class="n">myshader</span><span class="p">)</span>
<span class="o">...</span>
<span class="n">myshape</span><span class="o">.</span><span class="n">set_normal_shine</span><span class="p">(</span><span class="n">normtex</span><span class="p">,</span> <span class="n">ntiles</span><span class="o">..</span><span class="p">)</span> <span class="c1"># leaves the first texture if there</span>
<span class="o">...</span>
<span class="n">myshape</span><span class="o">.</span><span class="n">set_material</span><span class="p">(</span><span class="n">mtrl</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
</div></blockquote>
</div>
<div class="section" id="blending">
<h2>Blending<a class="headerlink" href="#blending" title="Permalink to this headline">¶</a></h2>
<p>How can I blend objects, why do objects vanish when they go behind a transparent
object and other questions to do with transparency (or apha property)</p>
<blockquote>
<div><p>Transparency of Shapes can be altered by 1. the set_alpha() method 2. the
alpha value of pixels in a png type image file 3. alpha value of the fog.
The blending of the pixels with alpha less than 1.0 is controlled by setting
Texture.blend to True or False.</p>
<p>The way that transparency is handled is quite hard to understand. Here is
some good information <a class="reference external" href="http://www.opengl.org/wiki/Transparency_Sorting">http://www.opengl.org/wiki/Transparency_Sorting</a></p>
<p>The graphics processor has a global setting to enable blending that is
switched on or off as each Shape is drawn, allowing or preventing the pixels
to be blended with whatever&#8217;s behind them. In pi3d this can be controlled by
setting the <code class="docutils literal"><span class="pre">blend=True</span></code> argument when the Texture is created or at a later
point by <code class="docutils literal"><span class="pre">mytexture.blend</span> <span class="pre">=</span> <span class="pre">True</span></code> In addition to this setting there is a check
in the draw() method so that blend is enabled when alpha is set to less than 1.0.</p>
<p>When the gpu is rendering an object there is a depth buffer that holds
information on how far from the camera each pixel has been drawn. Because
of this it is normally optimal to draw foreground objects first as there
is then less of the background to fill in. If the background was drawn
first then the same pixel might have to be redrawn several times as the
gpu found something else nearer to the view point. However the gpu
<strong>doesn&#8217;t</strong> take into account the transparency of the pixel when it&#8217;s
deciding if something is nearer or further away, so for blending
you have to draw things on top of other things...</p>
<p>Which sounds obvious but to give an example; if a slideshow tries to blend
between two images, one drawn in front of the other:</p>
<p>If you <strong>first</strong> draw the canvasFront (z=0.1) with alpha=0.1
<strong>then</strong> draw the canvasBack (z=0.2) with alpha=0.9 the result will
be a very faint image on canvasFront and nothing on canvasBack. Wrong!</p>
<p>i.e. canvasBack always has to be drawn first and if the application is purely
fading from one image to another it can leave canvasBack at apha=1.0 (i.e.
default value) and just increase then decrease the alpha of canvasFront</p>
<p>In addition to blending, when the Shader is rendering an object it discards
some pixels without drawing anything at all. The decision is based on the
alpha value of the pixel as read from the Texture. If blend is True then
pixels with alpha &lt; 0.05 are discarded if blend is False then pixels with
alpha &lt; 0.6 are discarded. This allows objects to be drawn after nearer objects
but still be seen through &#8216;holes&#8217; in the image. i.e. the trees in ForestWalk</p>
</div></blockquote>
<p>I want to use pi3d on the Raspberry Pi at the same time as other applications
that use the dispmanx display surfaces (omxplayer, wayland, kivy etc) how
can I set the layer to be in front or behind.</p>
<blockquote>
<div>There is an argument to <code class="docutils literal"><span class="pre">Display.create(...layer=0)</span></code> that you can
alter to change the order of layers. To draw <code class="docutils literal"><span class="pre">behind</span></code> the X11 desktop
on the Raspberry Pi Raspbian setup you need to set the layer to -128 see
the demo PyQtCube.py</div></blockquote>
</div>
<div class="section" id="materials">
<h2>Materials<a class="headerlink" href="#materials" title="Permalink to this headline">¶</a></h2>
<p>All the demos use images to create the surface patterns for shapes. Is
it possible to define a material color.</p>
<blockquote>
<div><p>The method <code class="docutils literal"><span class="pre">myshape.set_material((0.9,</span> <span class="pre">0.4,</span> <span class="pre">0.0))</span></code> can be used (the default
is <code class="docutils literal"><span class="pre">(0.5,</span> <span class="pre">0.5,</span> <span class="pre">0.5)</span></code>) but to render using this you need to use an appropriate
<a href="#id1"><span class="problematic" id="id2">mat_</span></a> shader:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">myshape</span><span class="o">.</span><span class="n">set_draw_details</span><span class="p">(</span><span class="n">shader</span><span class="p">,</span> <span class="p">[])</span> <span class="c1"># shader = Shader(&#39;mat_flat&#39;) uses no lighting</span>
<span class="n">myshape</span><span class="o">.</span><span class="n">set_draw_details</span><span class="p">(</span><span class="n">shader</span><span class="p">,</span> <span class="p">[])</span> <span class="c1"># mat_light uses a light</span>
<span class="n">myshape</span><span class="o">.</span><span class="n">set_draw_details</span><span class="p">(</span><span class="n">shader</span><span class="p">,</span> <span class="p">[</span><span class="n">bumptex</span><span class="p">],</span> <span class="mf">4.0</span><span class="p">)</span> <span class="c1"># mat_bump uses light and normal map</span>
<span class="n">myshape</span><span class="o">.</span><span class="n">set_draw_details</span><span class="p">(</span><span class="n">shader</span><span class="p">,</span> <span class="p">[</span><span class="n">bumptex</span><span class="p">,</span> <span class="n">shinetex</span><span class="p">],</span> <span class="mf">4.0</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">)</span> <span class="c1"># mat_shine uses light, normal map, reflection texture</span>
</pre></div>
</div>
<p>and one demo does use material color: Shapes.py look at the code for
the wine glass. Also, there is now a default instance for Shader so
if you try to draw a Shape without specifying a Shader it will load
and use <code class="docutils literal"><span class="pre">mat_light</span></code> which gives 3D shading but requires no Textures.</p>
</div></blockquote>
</div>
<div class="section" id="joysticks-etc">
<h2>joysticks etc<a class="headerlink" href="#joysticks-etc" title="Permalink to this headline">¶</a></h2>
<p>How do I use a joystick, gamepad, xbox controller etc with a pi3d
application?</p>
<blockquote>
<div><p>Often these will just work with the event module when plugged into the USB,
sometimes you may need to use a different InputEvents method, for instance
with an xbox 360 you get the left joystick from <code class="docutils literal"><span class="pre">get_joystickB3d()</span></code>
Also you would need to install the driver and start it running first:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">xboxdrv</span>
<span class="n">sudo</span> <span class="n">xboxdrv</span> <span class="o">-</span><span class="n">s</span> <span class="o">-</span><span class="n">i</span> <span class="mi">0</span>
</pre></div>
</div>
<p>See also in the section <code class="docutils literal"><span class="pre">Permission</span> <span class="pre">denied</span></code> below</p>
</div></blockquote>
</div>
<div class="section" id="d-models">
<h2>3D models<a class="headerlink" href="#d-models" title="Permalink to this headline">¶</a></h2>
<div class="section" id="making-3d-models">
<h3>Making 3D models<a class="headerlink" href="#making-3d-models" title="Permalink to this headline">¶</a></h3>
<p>How do I make my own 3D model to load into pi3d?</p>
<blockquote>
<div><p>You will need to &#8216;make&#8217; one on a bigger computer using 3D software such
as <code class="docutils literal"><span class="pre">blender</span></code>. This falls outside the scope of this FAQ but your best
option is to export the model as an obj file. In Bl2.6 options I specify:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Apply</span> <span class="n">Modifiers</span> <span class="p">(</span><span class="n">default</span><span class="p">)</span>
<span class="n">Include</span> <span class="n">Edges</span> <span class="p">(</span><span class="n">default</span><span class="p">)</span>
<span class="n">Include</span> <span class="n">Normals</span> <span class="p">(</span><span class="n">tick</span> <span class="n">this</span><span class="p">)</span> <span class="o">&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;</span> <span class="o">*</span>
<span class="n">Include</span> <span class="n">UVs</span> <span class="p">(</span><span class="n">default</span> <span class="n">but</span> <span class="n">see</span> <span class="n">below</span><span class="p">)</span>
<span class="n">Write</span> <span class="n">Materials</span> <span class="p">(</span><span class="n">default</span><span class="p">)</span>
<span class="n">Object</span> <span class="k">as</span> <span class="n">OBJ</span> <span class="n">Objects</span> <span class="p">(</span><span class="n">default</span><span class="p">)</span>

<span class="n">Forward</span> <span class="o">-</span><span class="n">Z</span> <span class="n">Forward</span> <span class="p">(</span><span class="n">default</span><span class="p">)</span>
<span class="n">Up</span> <span class="n">Y</span> <span class="n">Up</span> <span class="p">(</span><span class="n">default</span><span class="p">)</span>
<span class="n">these</span> <span class="n">last</span> <span class="n">two</span> <span class="n">will</span> <span class="n">mean</span> <span class="n">that</span><span class="o">..</span>
<span class="n">Blender</span><span class="o">.</span><span class="n">x</span><span class="o">=&gt;</span><span class="n">pi3d</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">Blender</span><span class="o">.</span><span class="n">y</span><span class="o">=&gt;</span><span class="n">pi3d</span><span class="o">.</span><span class="n">z</span><span class="p">,</span> <span class="n">Blender</span><span class="o">.</span><span class="n">z</span><span class="o">=&gt;</span><span class="n">pi3d</span><span class="o">.</span><span class="n">y</span> <span class="k">with</span> <span class="n">no</span> <span class="n">reflection</span>
<span class="n">of</span> <span class="n">whatever</span> <span class="n">you</span> <span class="n">design</span>
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">*</span></code> If you export without getting blender to Include Normals then pi3d
will have to generate them when the model is loaded. This is not a
good idea for several reasons: It will be slower to do on the pi then
on a &#8216;big&#8217; computer, it will have to be done every time the model is
loaded rather than just once, it will not give the fine control
available in blender to define the sharpness of edges.</p>
<p>NB You will need to define uv mapping even if you define a material
color and don&#8217;t intend to use a texture but might want to use a normal
mapping shader. To do this in blender you need to tab to edit mode, select
all vertices (a), unwrap (u, Unwrap). If the model has multiple objects
you will need to do this for each one. After you export you may need to
edit the <code class="docutils literal"><span class="pre">mtl</span></code> file so the relative path to the image is correct for
their locations on the pi. In programs such as blender it is also possible to
use a more detailed (high polygon) model to create a &#8216;normal map&#8217; image
that can be used to give surface detail to the model in pi3d. Quite
technical but lots of instructional videos on youtube!</p>
</div></blockquote>
</div>
<div class="section" id="imported-model-doesn-t-appear">
<h3>Imported model doesn&#8217;t appear<a class="headerlink" href="#imported-model-doesn-t-appear" title="Permalink to this headline">¶</a></h3>
<p>I have a 3D object in obj format which I tried to import into a scene, but
I do not see it! I used the file &#8216;LoadModelObj.py&#8217; which I modified. For
the model, I just took a logo I created a 3D extrusion in Photoshop and
I exported the layer in OBJ format [but seel also any other method of
creating 3D obj files]. The fact of not seeing it must be related to the
size of my model and the parameter of depth z in &#8216;Pi3D.model&#8217;. But I do
not know how to get the correct settings apart from trying random values.</p>
<blockquote>
<div><p>The first issue is with the x,y,z values of the vertices. You can check
these by opening the obj file in a text editor. In this case the y and z
values are very large: around -2100 and 1840. You can edit them to bring
the model nearer the origin by globally replacing using regular expressions
such as <code class="docutils literal"><span class="pre">Search</span> <span class="pre">For</span> <span class="pre">&quot;(</span> <span class="pre">-21)(..)&quot;</span> <span class="pre">Replace</span> <span class="pre">with</span> <span class="pre">&quot;</span> <span class="pre">\2&quot;</span></code>. Or write a simple
python program to go through all the lines of the obj file, parse out
the v lines and re-write them with altered values. Once the x,y,z values
are reasonable you can also import the model and adjust its position manually
on blender and re-export it. If needed you can also alter the scale of
the model. If the model is very large you will need to move it further
from the camera to see it all.</p>
<p>The second issue is that the uv mapping of textures in obj files is flipped
compared with the default pi3d sense so if you want to apply your own
texture you need to set the <code class="docutils literal"><span class="pre">flip=True</span></code> argument to Texture():</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">tex</span> <span class="o">=</span> <span class="n">pi3d</span><span class="o">.</span><span class="n">Texture</span><span class="p">(</span><span class="s1">&#39;Logo_IUT.png&#39;</span><span class="p">,</span> <span class="n">flip</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">bumptex</span> <span class="o">=</span> <span class="n">pi3d</span><span class="o">.</span><span class="n">Texture</span><span class="p">(</span><span class="s2">&quot;textures/floor_nm.jpg&quot;</span><span class="p">)</span>
<span class="n">shinetex</span> <span class="o">=</span> <span class="n">pi3d</span><span class="o">.</span><span class="n">Texture</span><span class="p">(</span><span class="s2">&quot;textures/stars.jpg&quot;</span><span class="p">)</span>
<span class="n">mymodel</span> <span class="o">=</span> <span class="n">pi3d</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="n">file_string</span><span class="o">=</span><span class="s1">&#39;Logo_IUT_3D_mod1.obj&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;teapot&#39;</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="mf">40.0</span><span class="p">)</span>
<span class="n">mymodel</span><span class="o">.</span><span class="n">set_draw_details</span><span class="p">(</span><span class="n">shader</span><span class="p">,</span> <span class="p">[</span><span class="n">tex</span><span class="p">,</span> <span class="n">bumptex</span><span class="p">,</span> <span class="n">shinetex</span><span class="p">],</span> <span class="mf">16.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
</pre></div>
</div>
<p>Alternatively in blender open the UV editor and specify the correct image
file to use as a Texture. When you export this it will create an associated
mtl file which will be picked up when you import the model in pi3d.</p>
</div></blockquote>
</div>
</div>
<div class="section" id="d-images">
<h2>2D images<a class="headerlink" href="#d-images" title="Permalink to this headline">¶</a></h2>
<div class="section" id="how-to-use-2d-images">
<h3>How to use 2D images<a class="headerlink" href="#how-to-use-2d-images" title="Permalink to this headline">¶</a></h3>
<p>Can I use pi3d for 2D images?</p>
<blockquote>
<div><p>There are various ways of doing this. The easiest way is to use the
image to texture a simple rectangle. The simplest shape to do this
is the Sprite which is also utilised by the ImageSprite shape to
allow the texture to be specified as it is created. The Plane object
is similar but is two sided. The advantage and disadvantage of this
method is that images will be different when viewed from different
locations.</p>
<p>If you specify an orthogrphic camera (set the argument
is_3d=False) then there will be no perspective (the image will not
get smaller as it moves away from the camera) and each unit of the
dimensions of the object will be one pixel on the screen. With both
these methods the shape can be rotated, moved and scaled in all
dimensions.</p>
<p>You can also use the shader 2d_flat which takes pixels from an image
and maps them to the screen, see below. The advantage of this
method is that it can use the even simpler Canvas object and it always
stays in the same place relative to the camera so you only need one
camera, which can be the default one that you don&#8217;t have to bother
creating. See below.</p>
<p>From v1.14 the Buffer.re_init() method (see below under <code class="docutils literal"><span class="pre">Is</span> <span class="pre">it</span>
<span class="pre">possible</span> <span class="pre">to</span> <span class="pre">change</span> <span class="pre">the</span> <span class="pre">shape...</span></code>) allows vertices to be moved
around quite easily. These vertices can be rendered as points and
the Shader can be made to draw an image or part of an image at each
point. This technique allows much larger numbers of sprites to be
drawn per frame, especially if the fast array processing power of
numpy is used as well. See the demos <code class="docutils literal"><span class="pre">SpriteBalls.py</span></code> and
<code class="docutils literal"><span class="pre">SpriteMulti.py</span></code></p>
</div></blockquote>
</div>
<div class="section" id="nearness-of-2d-relative-to-3d">
<h3>nearness of 2D relative to 3D<a class="headerlink" href="#nearness-of-2d-relative-to-3d" title="Permalink to this headline">¶</a></h3>
<p>How do I display 2D images in front of a 3D scene? (or behind, for that
matter)</p>
<blockquote>
<div><p>create two cameras one 3D and one 2D and assign the relevant camera
to the types of objects you want to be drawn by each method. You
can move the 3D camera around the scene but leave the 2D one stationary,
that way you won&#8217;t have to keep moving and rotating the 2D objects
to keep them in front of the camera.</p>
<p>Orthographic (2D) cameras will render objects with a z value that is
severely non linear and does not relate in a simple way to the z values
for the perspective camera. Generally 2D objects will be in front
of objects rendered by perspective (3D) cameras unless you assign
z values in the thousands. Too large a z value (&gt; 10000), though, and
they will disappear beyond the &#8216;far plane&#8217;. If z_o is the z value of a
Shape viewed with an orthographic camera and z_p is the z value of a Shape
viewed with a perspective camera then their relative distances during
rendering by the Shader (i.e. which obscures the other) follows:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">z_p</span> <span class="o">=</span> <span class="mi">10000</span> <span class="o">/</span> <span class="p">(</span><span class="mi">10000</span> <span class="o">-</span> <span class="n">z_o</span><span class="p">)</span> <span class="c1"># so z_o of 9000 gives z_p of 10</span>
<span class="n">z_o</span> <span class="o">=</span> <span class="mi">10000</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="n">z_p</span><span class="p">)</span>   <span class="c1"># so z_p of 500 gives z_o of 9980</span>
</pre></div>
</div>
<p>If you create a camera it will become the default instance so if you
need more than one you need to explicitly create them, and it&#8217;s a good
idea to assign the one you want to each object as an argument while
the object is being created.</p>
<p>Before the development of the orthographic Camera matrix system there
was a system of drawing onto a Canvas object using the 2d_flat shader.
This method is really deprecated though</p>
</div></blockquote>
</div>
<div class="section" id="nearness-of-pointtext-and-textblock-relative-to-other-2d-objects">
<h3>Nearness of PointText and TextBlock relative to other 2D objects<a class="headerlink" href="#nearness-of-pointtext-and-textblock-relative-to-other-2d-objects" title="Permalink to this headline">¶</a></h3>
<p>Even setting the z value of my TextBlock to a smaller value than an
ImageSprite z value it still gets drawn behind!</p>
<blockquote>
<div><p>The PointText/TextBlock system developed by Matt Coleman is very fast
and flexible but also quite complicated, especially hard to follow as the
demo tries to showcase all the features! One subtlety that isn&#8217;t obvious
is the fact that &#8216;extra&#8217; info is being shoehorned into the array passed
to the shader, critically the z value of each vertex (i.e. each character)
contains both the depth <em>and</em> the size. Coupled with the use of medium
precision floats this means that the behaviour of the depth and size values
of TextBlock seem very strange.</p>
<p>Depth as specified in TextBlock doesn&#8217;t match up with the normal depth
of 2D objects such as ImageSprite (this is different from the 2D v 3D depth
difference mentioned above) Keep the TextBlock z values small and the other
objects large (i.e. 0.5 may be in front of normal 2D z of 6.0 but behind
5.9 so play safe with a value of 50.0)</p>
<p>Size varies from 0.05 to 0.99 (subject to float precision) however if you
use a size of more than 1.0 it will effect the spacing! Try using 0.99, 1.99, 2.99 etc.</p>
</div></blockquote>
</div>
<div class="section" id="pointtext-stops-working-if-too-many-textblocks-added">
<h3>PointText stops working if too many TextBlocks added<a class="headerlink" href="#pointtext-stops-working-if-too-many-textblocks-added" title="Permalink to this headline">¶</a></h3>
<p>The text seemed to be drawing OK but when I added an extra TextBlock or
increased the amount of characters in a TextBlock it all stopped working.</p>
<blockquote>
<div>When you create a PointText object you have to specify the <code class="docutils literal"><span class="pre">max_chars</span></code>
argument and it will go horribly wrong if you exceed this as the speed
of this text display method relies on updating an existing buffer. There
is probably not too much of a penalty in making it a bit bigger than you
expect to use.</div></blockquote>
</div>
<div class="section" id="default-fog-distance">
<h3>Default fog distance<a class="headerlink" href="#default-fog-distance" title="Permalink to this headline">¶</a></h3>
<p>I&#8217;ve moved my yellow plane behind other objects by setting z=9900 and
viewing it with an orthographic camera. But it has become grey and
slightly transparent!</p>
<blockquote>
<div><p>The default Fog distance was set up before the orthographic camera
had been implemented. It is mid grey and ramps up to full strength at
z=5000. From v1.12 This will be increased but in the mean time you can:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">myshape</span><span class="o">.</span><span class="n">set_fog</span><span class="p">((</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span> <span class="mi">30000</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="pixel-perfect">
<h3>Pixel perfect<a class="headerlink" href="#pixel-perfect" title="Permalink to this headline">¶</a></h3>
<p>How do I display an image exactly without anti-aliasing or smoothing
i.e. pixel perfect?</p>
<blockquote>
<div><p>This can be done by using a Camera with argument <code class="docutils literal"><span class="pre">is_3d=False</span></code> and
spcifying, when the Texture is loaded, that <code class="docutils literal"><span class="pre">mipmap=False</span></code>. Because
this is a global setting it will be overwritten by whichever Texture is
the last to be loaded. Use the <code class="docutils literal"><span class="pre">uv_flat</span></code> shader and the Sprite or ImageSprite
Shape.</p>
<p>It is also important that the image is one of the standard widths used
by the GPU (see the FAQ section on <code class="docutils literal"><span class="pre">Texture</span> <span class="pre">blurring</span></code> below) also;
that the dimensions of the image are the same as the sprite.</p>
</div></blockquote>
</div>
<div class="section" id="anti-aliasing">
<h3>anti-aliasing<a class="headerlink" href="#anti-aliasing" title="Permalink to this headline">¶</a></h3>
<p>Where I have one shape in front of another with contrasting colors can
the diagonal line be anti-aliased to prevent &#8216;steppyness&#8217;?</p>
<blockquote>
<div><p>This can be done when the Display is created by setting the samples
argument to 4:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">DISPLAY</span> <span class="o">=</span> <span class="n">pi3d</span><span class="o">.</span><span class="n">Display</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">samples</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
<p>Generally the edges don&#8217;t look too bad, there is a small processing
cost associated with this sampling and there is a recorded instance
of the sampling causing an error when running pi3d on vmware on a
mac or when running on Windows.</p>
</div></blockquote>
</div>
<div class="section" id="texture-blurring">
<h3>Texture blurring<a class="headerlink" href="#texture-blurring" title="Permalink to this headline">¶</a></h3>
<p>Some of my Textures look a bit blurred or pixely.</p>
<blockquote>
<div><p>Early GPUs had to have image sizes of powers of 2 pixels. i.e.
2,4,8..1024,2048 because of the algorithm used for texture sampling,
but modern ones can manage with any dimensions. With the raspberry
pi we have found that some widths can cause rows of pixels to be
offset unless they fall on certain sizes (below). <strong>If the image
width is a value not in this list then it will be rescaled with a
resulting loss of clarity</strong></p>
<p>Allowed widths 4, 8, 16, 32, 48, 64, 72, 96, 128, 144, 192, 256, 288,
384, 512, 576, 640, 720, 768, 800, 960, 1024, 1080, 1920</p>
</div></blockquote>
</div>
<div class="section" id="display-size-greater-than-2048">
<h3>Display size greater than 2048<a class="headerlink" href="#display-size-greater-than-2048" title="Permalink to this headline">¶</a></h3>
<p>Is there any way to use monitors with higher resolution than the 2048 limit
of the OpenGL ES implementation on the Raspberry Pi?</p>
<blockquote>
<div><p>This is not straightforward but it is possible to use the python multiprocessing
module to run two instances of pi3d in different &#8220;slices&#8221; of the screen.
Because the processes are running in parallel there is a problem with
synchronisation, however for slow operations such as a slideshow this
can be reduced to an ammount that is indescernable. The code would be something
like:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pi3d</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">ctypes</span>
<span class="kn">from</span> <span class="nn">multiprocessing</span> <span class="k">import</span> <span class="n">Process</span>
<span class="kn">from</span> <span class="nn">multiprocessing.sharedctypes</span> <span class="k">import</span> <span class="n">RawArray</span><span class="p">,</span> <span class="n">RawValue</span>
<span class="kn">from</span> <span class="nn">PIL</span> <span class="k">import</span> <span class="n">Image</span>

<span class="n">W</span><span class="p">,</span> <span class="n">H</span> <span class="o">=</span> <span class="mi">2160</span><span class="p">,</span> <span class="mi">1440</span>
<span class="n">L_X</span><span class="p">,</span> <span class="n">L_Y</span><span class="p">,</span> <span class="n">L_W</span><span class="p">,</span> <span class="n">L_H</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">985</span><span class="p">,</span> <span class="mi">1440</span>
<span class="n">R_X</span><span class="p">,</span> <span class="n">R_Y</span><span class="p">,</span> <span class="n">R_W</span><span class="p">,</span> <span class="n">R_H</span> <span class="o">=</span> <span class="mi">985</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">W</span> <span class="o">-</span> <span class="mi">985</span><span class="p">,</span> <span class="mi">1440</span>
<span class="n">img</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;temp10.png&#39;</span><span class="p">,</span> <span class="s1">&#39;temp11.png&#39;</span><span class="p">]</span> <span class="c1">#images 2160x1440</span>
<span class="n">img_i</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">img_n</span> <span class="o">=</span> <span class="mi">2</span>

<span class="k">def</span> <span class="nf">leftScreen</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">flag</span><span class="p">):</span>
  <span class="n">L_display</span> <span class="o">=</span> <span class="n">pi3d</span><span class="o">.</span><span class="n">Display</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">L_X</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">L_Y</span><span class="p">,</span> <span class="n">w</span><span class="o">=</span><span class="n">L_W</span><span class="p">,</span> <span class="n">h</span><span class="o">=</span><span class="n">L_H</span><span class="p">)</span>
  <span class="n">L_camera</span> <span class="o">=</span> <span class="n">pi3d</span><span class="o">.</span><span class="n">Camera</span><span class="p">(</span><span class="n">is_3d</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
  <span class="n">L_shader</span> <span class="o">=</span> <span class="n">pi3d</span><span class="o">.</span><span class="n">Shader</span><span class="p">(</span><span class="s1">&#39;uv_flat&#39;</span><span class="p">)</span>
  <span class="n">L_sprite</span> <span class="o">=</span> <span class="n">pi3d</span><span class="o">.</span><span class="n">Sprite</span><span class="p">(</span><span class="n">w</span><span class="o">=</span><span class="n">L_W</span><span class="p">,</span> <span class="n">h</span><span class="o">=</span><span class="n">L_H</span><span class="p">,</span> <span class="n">camera</span><span class="o">=</span><span class="n">L_camera</span><span class="p">)</span>
  <span class="n">L_tex_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">frombuffer</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
  <span class="n">L_tex_arr</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
  <span class="k">while</span> <span class="n">L_display</span><span class="o">.</span><span class="n">loop_running</span><span class="p">():</span>
    <span class="k">while</span> <span class="n">flag</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
      <span class="k">pass</span>
    <span class="k">if</span> <span class="n">flag</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
      <span class="k">break</span>
    <span class="n">L_tex</span> <span class="o">=</span> <span class="n">pi3d</span><span class="o">.</span><span class="n">Texture</span><span class="p">(</span><span class="n">L_tex_arr</span><span class="p">[:,:</span><span class="n">L_W</span><span class="p">,:]</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
    <span class="n">L_sprite</span><span class="o">.</span><span class="n">set_draw_details</span><span class="p">(</span><span class="n">L_shader</span><span class="p">,</span> <span class="p">[</span><span class="n">L_tex</span><span class="p">])</span>
    <span class="n">flag</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">L_sprite</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
  <span class="n">L_display</span><span class="o">.</span><span class="n">destroy</span><span class="p">()</span>

<span class="n">flag</span> <span class="o">=</span> <span class="n">RawValue</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_int</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">shared_arr</span> <span class="o">=</span> <span class="n">RawArray</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_uint8</span><span class="p">,</span> <span class="n">H</span> <span class="o">*</span> <span class="n">W</span> <span class="o">*</span> <span class="mi">4</span><span class="p">)</span> <span class="c1"># alternatively, Array automatically does locking in which case</span>
<span class="n">tex_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">frombuffer</span><span class="p">(</span><span class="n">shared_arr</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span> <span class="c1"># you need to call Array.get_obj() method here</span>
<span class="n">tex_arr</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>

<span class="n">p</span> <span class="o">=</span> <span class="n">Process</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">leftScreen</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">shared_arr</span><span class="p">,</span> <span class="n">flag</span><span class="p">))</span>
<span class="n">p</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

<span class="n">display</span> <span class="o">=</span> <span class="n">pi3d</span><span class="o">.</span><span class="n">Display</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">R_X</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">R_Y</span><span class="p">,</span> <span class="n">w</span><span class="o">=</span><span class="n">R_W</span><span class="p">,</span> <span class="n">h</span><span class="o">=</span><span class="n">R_H</span><span class="p">)</span>
<span class="n">camera</span> <span class="o">=</span> <span class="n">pi3d</span><span class="o">.</span><span class="n">Camera</span><span class="p">(</span><span class="n">is_3d</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">shader</span> <span class="o">=</span> <span class="n">pi3d</span><span class="o">.</span><span class="n">Shader</span><span class="p">(</span><span class="s1">&#39;uv_flat&#39;</span><span class="p">)</span>
<span class="n">sprite</span> <span class="o">=</span> <span class="n">pi3d</span><span class="o">.</span><span class="n">Sprite</span><span class="p">(</span><span class="n">w</span><span class="o">=</span><span class="n">R_W</span><span class="p">,</span> <span class="n">h</span><span class="o">=</span><span class="n">R_H</span><span class="p">,</span> <span class="n">camera</span><span class="o">=</span><span class="n">camera</span><span class="p">)</span>

<span class="n">tm</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">while</span> <span class="n">display</span><span class="o">.</span><span class="n">loop_running</span><span class="p">()</span> <span class="ow">and</span> <span class="n">tm</span> <span class="o">&lt;</span> <span class="mi">800</span><span class="p">:</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">tm</span> <span class="o">%</span> <span class="mi">100</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">tex_arr</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">img</span><span class="p">[</span><span class="n">img_i</span><span class="p">]))</span>
    <span class="n">flag</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">img_i</span> <span class="o">=</span> <span class="p">(</span><span class="n">img_i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">img_n</span>
    <span class="n">tex</span> <span class="o">=</span> <span class="n">pi3d</span><span class="o">.</span><span class="n">Texture</span><span class="p">(</span><span class="n">tex_arr</span><span class="p">[:,</span><span class="n">R_X</span><span class="p">:,:]</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
    <span class="n">sprite</span><span class="o">.</span><span class="n">set_draw_details</span><span class="p">(</span><span class="n">shader</span><span class="p">,</span> <span class="p">[</span><span class="n">tex</span><span class="p">])</span>
  <span class="k">while</span> <span class="n">flag</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
    <span class="k">pass</span>
  <span class="n">sprite</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
  <span class="n">tm</span> <span class="o">+=</span> <span class="mi">1</span>

<span class="n">flag</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">shared_arr</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">display</span><span class="o">.</span><span class="n">destroy</span><span class="p">()</span>
</pre></div>
</div>
</div></blockquote>
</div>
</div>
<div class="section" id="log-messages">
<h2>Log messages<a class="headerlink" href="#log-messages" title="Permalink to this headline">¶</a></h2>
<p>When the demos start there is sometimes a message in the terminal
looking like:
<code class="docutils literal"><span class="pre">2013-08-19</span> <span class="pre">15:36:46,232</span> <span class="pre">INFO:</span> <span class="pre">__main__:</span> <span class="pre">Starting</span> <span class="pre">CollisionBalls</span></code>
Where does that come from and what does it mean?</p>
<blockquote>
<div><p>The Log module used to be started by several of the basic classes (Buffer,
EventStream, Display, Loadable, Mouse, parse_mtl, Shader, Screenshot)
However there were issues with this adding event handlers into the python
logger hierarchy. In version v2.17 the logging within the pi3d module
classes was switched to use the normal python logging.</p>
<p>The example logger message above is shown because the CollisionBalls demo
makes use of the pi3d.Log class.</p>
</div></blockquote>
<div class="section" id="how-to-use-logging">
<h3>How to use logging<a class="headerlink" href="#how-to-use-logging" title="Permalink to this headline">¶</a></h3>
<p>How do I use <code class="docutils literal"><span class="pre">pi3d.Log</span></code> to gather or display useful information
in my application?</p>
<blockquote>
<div>pi3d.Log is a wrapper for python logging. You use it by making an instance
of this class in your application then calling the methods <code class="docutils literal"><span class="pre">debug()</span></code>
<code class="docutils literal"><span class="pre">info()</span></code> <code class="docutils literal"><span class="pre">warning()</span></code> etc. Whether the message is logged depends on the
<code class="docutils literal"><span class="pre">level</span></code> set and whether it appears on screen or is sent to file and
the formatting or additional info can also be controlled. See the documentation
<a class="reference external" href="http://pi3d.github.io/html/pi3d.util.html#module-pi3d.util.Log">here</a>.</div></blockquote>
</div>
<div class="section" id="printed-messages-not-visible-on-raspberry-pi">
<h3>Printed messages not visible on Raspberry Pi<a class="headerlink" href="#printed-messages-not-visible-on-raspberry-pi" title="Permalink to this headline">¶</a></h3>
<p>Sometimes I can&#8217;t get printed messages to show in the terminal
when running on the Raspberry Pi and it makes it hard to debug the program.
Sometimes they show but the carriage returns just do line feeds so the text
works its way across the terminal window.</p>
<blockquote>
<div><p>This is a side effect of using ncurses for the pi3d.Keyboard which makes
it fairly universal where the program is exited by watching for the ESC
key.</p>
<p>A solution is to use the pi3d.Log class and send the output to a file.
See the <a class="reference external" href="https://github.com/pi3d/pi3d_demos/blob/master/Blur.py#L29">Blur.py demo</a>
and the pi3d.Log module documentation (link above)</p>
</div></blockquote>
</div>
</div>
<div class="section" id="moving-shapes-together">
<h2>Moving shapes together<a class="headerlink" href="#moving-shapes-together" title="Permalink to this headline">¶</a></h2>
<p>How do I keep two components (Shapes) &#8216;joined together&#8217; as they pitch, roll
and rotate (yaw), like the TigerTank does with its body, turret and gun?</p>
<blockquote>
<div>This can be done automatically by adding Shapes to other Shapes.children
lists which can be done using the Shape.add_child() method. All transformation
applied to a Shape will then be relative to its parent and will be
inherited its children. See the drawTiger function in <code class="docutils literal"><span class="pre">TigerTank.py</span></code>.</div></blockquote>
</div>
<div class="section" id="angle-of-bank">
<h2>Angle of bank<a class="headerlink" href="#angle-of-bank" title="Permalink to this headline">¶</a></h2>
<p>I want to give my shape an angle of bank (z-axis rotation) which it
maintains as it turns (y-axis rotation) - like an aeroplane. However the
z-rotation is always relative to the absolute frame of reference so the shape
pitches backwards and forwards as it turns. How do I make the frame of
reference rotate with the shape?</p>
<blockquote>
<div><p>This is because of the order of the transformations done prior to
redrawing the scene (z, then x, then y). You have to work out what the pitch
and roll would have to be prior to rotating them about their own y axis!
To see what I mean watch the behaviour of the tanks in demos/TigerTank.py
You have to figure out the &#8216;slope of the ground&#8217; so that when your
aeroplane (or boat) is rotated it ends up with the correct pitch and
roll. For a shape with zero pitch you can use something like:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">absheel</span> <span class="o">=</span> <span class="n">degrees</span><span class="p">(</span><span class="n">asin</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">radians</span><span class="p">(</span><span class="n">heel</span><span class="p">))</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">radians</span><span class="p">(</span><span class="n">heading</span><span class="p">))))</span>
<span class="n">abspitch</span> <span class="o">=</span> <span class="n">degrees</span><span class="p">(</span><span class="n">asin</span><span class="p">(</span><span class="o">-</span><span class="n">sin</span><span class="p">(</span><span class="n">radians</span><span class="p">(</span><span class="n">heel</span><span class="p">))</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">radians</span><span class="p">(</span><span class="n">heading</span><span class="p">))))</span>
<span class="n">hull</span><span class="o">.</span><span class="n">position</span><span class="p">(</span><span class="n">xm</span><span class="p">,</span> <span class="n">ym</span><span class="p">,</span> <span class="n">zm</span><span class="p">)</span>
<span class="n">hull</span><span class="o">.</span><span class="n">rotateToX</span><span class="p">(</span><span class="n">abspitch</span><span class="p">)</span>
<span class="n">hull</span><span class="o">.</span><span class="n">rotateToY</span><span class="p">(</span><span class="o">-</span><span class="n">heading</span><span class="p">)</span>
<span class="n">hull</span><span class="o">.</span><span class="n">rotateToZ</span><span class="p">(</span><span class="n">absheel</span><span class="p">)</span>
</pre></div>
</div>
<p>And see the <code class="docutils literal"><span class="pre">DogFight.py</span></code> version which has an extra degree
of freedom.</p>
<p>Generally problems like this can be done most easily by using the parent
child structure as described above in <code class="docutils literal"><span class="pre">Moving</span> <span class="pre">shapes</span> <span class="pre">together</span></code></p>
</div></blockquote>
</div>
<div class="section" id="moving-vertices-of-existing-shape">
<h2>Moving vertices of existing Shape<a class="headerlink" href="#moving-vertices-of-existing-shape" title="Permalink to this headline">¶</a></h2>
<p>Is it possible to change the shape of an object once it&#8217;s been made?</p>
<blockquote>
<div><p>The most efficient way is to use the scale(sx, sy, sz) method. However,
this obviously limits the shape changing that can take place. If the
shape needs to be changed more than this then it can be remade as
a new instance to replace the old one. (At one stage it was necessary to
clear the previous opengles buffers using the unload_opengl() method
before destroying the old shape to stop a graphics memory leak.
This issue seems to be fixed but if you run into memory problems
it might be worth trying this. Plus, obviously, report it to us!)</p>
<p>The alternative (faster, better) way of doing it is to use the Buffer.re_init()
method which takes arguments to set new values for pts (i.e. vertices),
texcoords and normals. These are passed as lists of xyz or uv lists or tuples
or better, two dimentional numpy arrays. An offset argument can also be
passed to allow only a section of vertices (normals or texcoords) to
be modified. re_init() can&#8217;t change the number of vertices, just move
them around. See the demos <code class="docutils literal"><span class="pre">IceGrow.py</span></code> and <code class="docutils literal"><span class="pre">ProceduralTerrain.py</span></code>.</p>
</div></blockquote>
</div>
<div class="section" id="slow-animation">
<h2>Slow animation<a class="headerlink" href="#slow-animation" title="Permalink to this headline">¶</a></h2>
<p>Sometime, when I move the mouse or the program is loading a file from
disk, everything slows down or freezes.</p>
<blockquote>
<div><p>The Display has a frames_per_second argument and if you set this
lower than the flat out rate it will give the processor some &#8216;slack&#8217;
to accomplish other jobs.</p>
<p>To do things like file loading in the background (for instance, preloading
an image or Shape so that it can instantly appear later) you need to use
Python&#8217;s threading - <code class="docutils literal"><span class="pre">Slideshow_2d.py</span></code> is an example.</p>
</div></blockquote>
<div class="section" id="slow-on-non-raspberry-pi-machine">
<h3>Slow on non-raspberry pi machine<a class="headerlink" href="#slow-on-non-raspberry-pi-machine" title="Permalink to this headline">¶</a></h3>
<p>I am running pi3d on a non-raspberry pi Linux machine but it&#8217;s running
at a very slow frame rate.</p>
<blockquote>
<div>Probably the GPU can&#8217;t run the OpenGL2+ code that mesa interprets
from the pi3d OpenGLES2 commands. Check the specification for the
graphics card. <code class="docutils literal"><span class="pre">lspci</span> <span class="pre">-v</span></code> and <code class="docutils literal"><span class="pre">feedback.wildfiregames.com/report/opengl/</span></code></div></blockquote>
</div>
<div class="section" id="unresponsive-mouse-movement">
<h3>unresponsive mouse movement<a class="headerlink" href="#unresponsive-mouse-movement" title="Permalink to this headline">¶</a></h3>
<p>Using python3 and the InputEvents mouse input (Silo and DogFight demos)
I get very ragged and unresponsive camera movment.</p>
<blockquote>
<div>This should be fixed as of v1.5, try upgrading to the latest
version of pi3d</div></blockquote>
</div>
</div>
<div class="section" id="permission-denied">
<h2>Permission denied<a class="headerlink" href="#permission-denied" title="Permalink to this headline">¶</a></h2>
<p>Some of the demos on a non-raspberry pi Linux machine work fine but
other don&#8217;t run and give an error:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="ne">IOError</span><span class="p">:</span> <span class="p">[</span><span class="n">Errno</span> <span class="mi">13</span><span class="p">]</span> <span class="n">Permission</span> <span class="n">denied</span><span class="p">:</span> <span class="s1">u&#39;/dev/input/mice&#39;</span>
</pre></div>
</div>
<p>what is the
cause of this</p>
<blockquote>
<div><p>The default Mouse gets its info from the operating system file described
in the error message. This requires it to be run from root, you can do
this by <code class="docutils literal"><span class="pre">sudo</span> <span class="pre">python</span> <span class="pre">ForestWalk.py</span></code>.</p>
<p>Alternatively, from v2.7, there is an argument to Display.create()
<code class="docutils literal"><span class="pre">use_pygame=True</span></code> which will use mouse and keyboard input from a pygame
display - the system that is used on Windows. See also below...</p>
<p><strong>NB</strong> A better fix for the access to  /dev/input/ on laptops etc it to
add your user to the <code class="docutils literal"><span class="pre">input</span></code> group. On this ubuntu 14.04 computer I
did:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ getent group # to see if there was an existing group &#39;input&#39; which there wasn&#39;t
$ sudo groupadd -f input
$ sudo gpasswd -a USERNAMEHERE input
$ sudo nano /etc/udev/rules.d/pi3d.rules
# new file to which just had this line
SUBSYSTEM==&quot;input&quot;, MODE=&quot;666&quot;
# restart computer
</pre></div>
</div>
<p>This should also get the input events system working as used in Silo and
allow joysticks and xbox controllers to be used. Thanks to Piotr Bednarski
for sorting this out.</p>
</div></blockquote>
</div>
<div class="section" id="full-screen">
<h2>Full Screen<a class="headerlink" href="#full-screen" title="Permalink to this headline">¶</a></h2>
<p>I would like to have a fullscreen frameless/borderless window for pi3d when
running under x/mesa.  It should looks just like it does for the RPi.</p>
<blockquote>
<div>If the <code class="docutils literal"><span class="pre">use_pygame=True</span></code> argument is used for Display.create() and no
w, h, x, y values are given then the pygame supplied drawing surface will
be full screen without borders.</div></blockquote>
</div>
<div class="section" id="post-processing">
<h2>Post processing<a class="headerlink" href="#post-processing" title="Permalink to this headline">¶</a></h2>
<p>How do I do post-rendering processing on a scene, such as blurring,
edge detection or fancier effects such as oil painting.</p>
<blockquote>
<div>There is a class PostProcess that can be used to render a scene to
a texture. The Post.py demo shows a simple 3x3 convolution matrix
shader and there are a host of post process filter shaders that
are in the pi3d_demos/shaders directory. These wll be loaded in
turn by <code class="docutils literal"><span class="pre">FilterDemo.py</span></code> but the pi will run out of graphics memory
if you leave the full list in. For more complicated effects it&#8217;s
over to you!</div></blockquote>
<div class="section" id="postprocess-class">
<h3>PostProcess class<a class="headerlink" href="#postprocess-class" title="Permalink to this headline">¶</a></h3>
<p>OK the example for post processing (Post.py) is quite hard to follow
how exactly does the PostProcess class work.</p>
<blockquote>
<div><p>PostProcess inherits from Texture (via OffScreenTexture) so you can
use an instance of it anywhere you would use a texture, i.e. you
could uv map it onto any other shape or use it as a bump or
reflection map. Or use it with your own shader to do something I
haven&#8217;t thought of. PostProcess.sprite is a Sprite shape that can
be used just as any other Shape in your program, you could rotate
it or change its alpha value or z location to draw it in front of
other objects. There is also a 2D camera created in PostProcess
which is used to draw the sprite at full screen using the saved
texture and the shader you supply in the constructor or post_base
if you don&#8217;t supply one.</p>
<p>PostProcess.draw({48:1.1414, 49:2013, 50:0.0}) will set the unif
array in PostProcess.sprite as unif[48] = 1.1414 unif[49] = 2013
unif[50] = 0.0 you can then access these values as uniform
variables in your shader as vec3 unif[16][0] unfi[16][1]
unfi[16][2]. If the array indices are contiguous you could do the
same thing using PostProcess.sprite.set_custom_data(48, [1.1414,
2013, 0.0]) or even PostProcess.sprite.unif[48] = 1.1414 etc</p>
<p>I see no reason why you shouldn&#8217;t do something like:
render the scene to a texture once a second draw it off-screen using
a shader to extract edges as dayglo on white, blur them to a second
texture, draw this onto a foreground sprite fading from alpha 0 to
1 back to 0 over 1s cycle. Use a different shader to draw the original
texture onto a spherical surface that gradually changes shape in
the background. etc etc.</p>
</div></blockquote>
</div>
<div class="section" id="is-it-possible-to-access-the-postprocess-image-as-a-numpy-array">
<h3>Is it possible to access the PostProcess image as a numpy array<a class="headerlink" href="#is-it-possible-to-access-the-postprocess-image-as-a-numpy-array" title="Permalink to this headline">¶</a></h3>
<p>In order to get the pixels &#8216;out of&#8217; the GPU memory into CPU space, the only way
I have found is to do something like:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">ctypes</span>
<span class="o">...</span>
<span class="n">ntex</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">post</span><span class="o">.</span><span class="n">iy</span><span class="p">,</span> <span class="n">post</span><span class="o">.</span><span class="n">ix</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span> <span class="c1"># make an empty array of the correct size</span>
<span class="o">...</span>
  <span class="c1"># inside the drawing loop. If you are offscreen rendering then you need to do this</span>
  <span class="c1">#  BEFORE you switch back to the normal view with end_capture</span>
  <span class="n">pi3d</span><span class="o">.</span><span class="n">opengles</span><span class="o">.</span><span class="n">glReadPixels</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">post</span><span class="o">.</span><span class="n">ix</span><span class="p">,</span> <span class="n">post</span><span class="o">.</span><span class="n">iy</span><span class="p">,</span> <span class="n">pi3d</span><span class="o">.</span><span class="n">GL_RGBA</span><span class="p">,</span> <span class="n">pi3d</span><span class="o">.</span><span class="n">GL_UNSIGNED_BYTE</span><span class="p">,</span>
                                <span class="n">ntex</span><span class="o">.</span><span class="n">ctypes</span><span class="o">.</span><span class="n">data_as</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">POINTER</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_short</span><span class="p">)))</span>
</pre></div>
</div>
<p>But glReadPixels is relatively slow compared with rendering to and
then drawing with a renderbuffer object so don&#8217;t expect a fantastic framerate.</p>
</div>
<div class="section" id="python-v-shader-unif-arrays">
<h3>python v. shader unif arrays<a class="headerlink" href="#python-v-shader-unif-arrays" title="Permalink to this headline">¶</a></h3>
<p>And why does python set Shape.unif[48] but the shader use
vec3 unif[16][0].</p>
<blockquote>
<div><p>On the shader side it&#8217;s really efficient to define variables as
vec3, vec4, mat4 etc. and at one stage I tried doing a lot of the
matrix manipulation in the vertex shader. There were pros and
cons but in the end I found that using python&#8217;s numpy library
was the best bet. But in the mean time I had started storing
much of the shape information in a form that allowed it to be
accessible by the shader i.e. location x,y,z was vec3 unif[0]
in the shader, rotation was vec3 unif[1], scale unif[2], origin
offset unif[3] etc. Although I no longer needed these for normal
rendering I thought that they may come in useful for someone at
some stage so I just left them. I only needed to pass one array
pionter so there was no cost to having 60 floats available!</p>
<p>Meanwhile back in the python description of the Shape I had to
make the unif array a ctypes.c_float array and that seemed to
have to be one-dimensional. So after a long story unif[16][0]
in the shader is (same name but different) unif[16*3 + 0] in python</p>
</div></blockquote>
</div>
</div>
<div class="section" id="blend-shaders">
<h2>Blend shaders<a class="headerlink" href="#blend-shaders" title="Permalink to this headline">¶</a></h2>
<p>How do the blend shaders work as used in the PictureFrame
demo</p>
<blockquote>
<div><p>These shaders are based on the 2d_flat shader (as mentioned above)
that uses the screen coordinates of each pixel, rather than the
interpolated coordinates of 3D polygon uv values, to look up the
color values. The main differences from 2d_flat are 1. There are
two textures passed to the shader 2. There are two sets of x, y, w,
h and screen height values passed to the shaders (one for each texture)
3. There is a time value passed to the shader varying from 0.0 to 1.0
to control the proportion of blending 4. There is a blending function!</p>
<p>If you look at the code for blend_bump.vs (and the other blend vertex
shaders) you will see that it calculates two vec2 varying values that
are passed to the fragment shader. The sole reason for doing this is
relative expense of dividing by a variable compared with multiplication
in the fragment shader. The values are used to scale the pixel locations
to texture lookup locations.</p>
<p>All of the fragment shaders then operate in a fairly similar way: pick
up the fading factor (tm = unif[14][2]), define coord as the pixel
location on the screen, for the foreground and background textures
check if the pixel falls outside the texture, if it doesn&#8217;t then look
up the RGBA value from the texture.</p>
<p>Having got the foreground and background pixel values there is then
a process of combining them which generally involves calculating a
factor dependent on some or all of a) pixel values b) x,y location
on the screen c) tm. Using the factor in a mix() function.</p>
<p><code class="docutils literal"><span class="pre">bump</span></code>: generates a factor as if the background texture was a normal
map to modify the foreground as it blends from one to the other</p>
<blockquote>
<div><img alt="_images/blend_bump_exp.png" src="_images/blend_bump_exp.png" />
</div></blockquote>
<p><code class="docutils literal"><span class="pre">burn</span></code>: compares the brightness of the background pixel with a sliding
threshold to determine how much to mix the foreground and background
<code class="docutils literal"><span class="pre">false</span></code>: creates a false middle color using factors acting on the
foreground and background RGB values and blends to and from the mid
color</p>
<blockquote>
<div><img alt="_images/blend_false_exp.png" src="_images/blend_false_exp.png" />
</div></blockquote>
<p><code class="docutils literal"><span class="pre">holes</span></code>: uses the distance from a grid of points to determine the proportion
of mixing
<code class="docutils literal"><span class="pre">star</span></code>: calculates the pixel position in polar coordinates (angle and
radius) then does some trig to determine the blend proportion</p>
</div></blockquote>
</div>
<div class="section" id="points">
<h2>Points<a class="headerlink" href="#points" title="Permalink to this headline">¶</a></h2>
<p>How can I render points like a star field
or sparks from an explosion.</p>
<blockquote>
<div><p>If you use the method set_point_size() on a Shape to a value other
than 0.0 then the vertices of the Shape will be rendered as points.
The size will actually vary with distance but will be the size you
specified at 1 unit of distance from the camera.</p>
<p>pi3d.Points can be used to render points using the mat_flat shader
or special shaders as used in the demo <code class="docutils literal"><span class="pre">SpriteMulti.py</span></code></p>
</div></blockquote>
</div>
<div class="section" id="lines">
<h2>Lines<a class="headerlink" href="#lines" title="Permalink to this headline">¶</a></h2>
<p>How can I render lines such as graphs or axes or the &#8216;wireframe&#8217; version
of a Shape.</p>
<blockquote>
<div><p>If you use Shape.set_line_width() then the the Buffer objects in the Shape
will have their draw_method set to GL_LINE_STRIP which will join all
the vertices as point on a line. There is an optional argument <code class="docutils literal"><span class="pre">closed</span></code>
that defaults to False which can be used to join the last vertex back
to the first (by setting draw_method to GL_LINE_LOOP). To create your
own lines you would need to make a list of (x,y,z) vertices and an
element array to join them together and pass them to the Buffer constructor.
The pi3d.Lines class does this for you.</p>
<p>It is possible to create multiple Buffers within a Shape and set some
as faces (draw_method set to GL_TRIANGLES) and some as points or lines.
You can set different Shaders for different Buffers from v2.6</p>
</div></blockquote>
</div>
<div class="section" id="using-numpy-arrays-for-textures">
<h2>Using numpy arrays for Textures<a class="headerlink" href="#using-numpy-arrays-for-textures" title="Permalink to this headline">¶</a></h2>
<p>I would like to do fast array processing with numpy and use the results
directly as Textures in pi3d. How do I do this?</p>
<blockquote>
<div><p>You can pass either a PIL Image or a numpy array directly to the Texture
class as it creates an instance. The numpy array will need to have shape
(H, W, N) where N is 4, 3 or 1 and the array must be <code class="docutils literal"><span class="pre">dtype=np.uint8</span></code>
If you attempt to use a slice of another array the resultant texture will
be scrambled unless you make an explicit copy i.e.:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">ar</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[[</span><span class="mi">2</span> <span class="o">*</span> <span class="n">i</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">j</span> <span class="o">-</span> <span class="n">i</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">128</span><span class="p">)]</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">128</span><span class="p">)],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="n">tex</span> <span class="o">=</span> <span class="n">pi3d</span><span class="o">.</span><span class="n">Texture</span><span class="p">(</span><span class="n">ar</span><span class="p">[:</span><span class="mi">50</span><span class="p">,:</span><span class="mi">100</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span> <span class="c1"># try without copy()</span>
</pre></div>
</div>
<p>To refresh the Texture with a constantly changing numpy array use the
<code class="docutils literal"><span class="pre">Texture.update_ndarray()</span></code> method. This can be passed the new array
as an argument, alternatively and faster, the Texture.image ndarray can
be modified in situ and update_ndarray() called without any arguments.</p>
</div></blockquote>
</div>
<div class="section" id="assigning-different-textures-to-vertex-groups">
<h2>Assigning different Textures to vertex groups<a class="headerlink" href="#assigning-different-textures-to-vertex-groups" title="Permalink to this headline">¶</a></h2>
<p>I want an ElevationMap with more detailed textures mapped to different areas.
i.e. rock, grass, heather, swamp.</p>
<blockquote>
<div>From v2.19 there are ready made shaders included to do this as well as an
argument to specify how up to four different diffuse textures along with
four different normal maps can be allocated on a vertex by vertex basis
- see the github.com/pi3d/pi3d_demos/ElevMapWalk.py demo.</div></blockquote>
</div>
<div class="section" id="without-pil-pillow">
<h2>Without PIL (Pillow)<a class="headerlink" href="#without-pil-pillow" title="Permalink to this headline">¶</a></h2>
<p>Can I use pi3d without installing PIL - for instance trying to
run on a different platform or to have an ultra small SD image?</p>
<blockquote>
<div><p>Yes as of v2.15 you can do this but some of the classes will not work
i.e. FixedString, Font, Building</p>
<p>The Pngfont will still work for rendering text. HOWEVER normal image files
cannot be imported (jpg, png, gif) instead you have to convert these into
compressed saved numpy files (npz) including any png files used as fonts.
This can be done using a simple script on a machine that does have PIL
installed:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">PIL</span> <span class="k">import</span> <span class="n">Image</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">dirctry</span> <span class="o">=</span> <span class="s1">&#39;textures&#39;</span>
<span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">dirctry</span><span class="p">):</span>
  <span class="n">f</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">f</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;jpg&#39;</span><span class="p">,</span><span class="s1">&#39;png&#39;</span><span class="p">,</span><span class="s1">&#39;gif&#39;</span><span class="p">]:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="n">im</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">/</span><span class="si">{}</span><span class="s1">.</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dirctry</span><span class="p">,</span> <span class="n">f</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">f</span><span class="p">[</span><span class="mi">1</span><span class="p">])))</span>
    <span class="n">np</span><span class="o">.</span><span class="n">savez_compressed</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">/</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dirctry</span><span class="p">,</span> <span class="n">f</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">im</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="minimal-sd-card">
<h2>Minimal SD card<a class="headerlink" href="#minimal-sd-card" title="Permalink to this headline">¶</a></h2>
<p>How can I set up an SD card without all of Raspbian&#8217;s clutter that will
boot quickly and allow me to run a dedicated pi3d application.</p>
<blockquote>
<div><p>This is what I did to get a version of the PictureFrame demo running
on a Raspberry Pi that I wanted to just do this job without the need for
Wolfram, Scratch or even the X11 desktop system.</p>
<p>1. The Raspberry Pi Foundation hosts a &#8216;stripped down&#8217; version of Raspbian
Jessie LITE avaliable at <a class="reference external" href="https://www.raspberrypi.org/downloads/raspbian/">https://www.raspberrypi.org/downloads/raspbian/</a>
which can be downloaded and burned to SD following the instructions there.</p>
<p>2. Start the Raspberry Pi logging in as user pi, password raspberry
then:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ sudo raspi-config
- boot options: console login as pi automatically
- internationalisation options: select relevant city
- expand file system
- (optional) change user password
- advanced: increase graphics memory to 128
- advanced: enable SSL
</pre></div>
</div>
<p>3. Install just the software to run the
application:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ sudo apt-get update
$ sudo apt-get upgrade
$ sudo apt-get install python3
$ sudo apt-get install python3-numpy
$ sudo apt-get install python3-pillow
$ sudo apt-get install python3-pip
$ pip install pi3d
</pre></div>
</div>
<p>4. Download the modified project
from github:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ wget https://github.com/paddywwoof/pi3d_pictureframe/archive/master.zip
$ unzip master.zip
$ rm master.zip
$ mv pi3d_pictureframe-master pi3d_pictureframe
$ cd pi3d_pictureframe
</pre></div>
</div>
<p>5. Checkout the excellent documentation by <a class="reference external" href="https://www.dropbox.com/sh/ydo0xkz48yi0mk2/AADyzbHhCMshFG85c5VJPX5ka/2%20-%20How%20to%20add%20great%20slide%20transitions%20-%20Tathros%20Photography.pdf?dl=0">Tathros</a> on which I have based
these instructions. The main differences are getting it to work
in console mode, without the need for a desktop environment:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>### screen application needed to show output run from crontab ######
$ sudo apt-get install screen

### turn off screensaver ###########################################
$ sudo nano /etc/kbd/config
... BLANK_TIME=0
...
... POWERDOWN_TIME=0
CtrlX,Y,Rtn

### set up wifi (you will need dongle if RPi &lt; 3) ##################
$ sudo nano /etc/wpa_supplicant/wpa_supplicant.conf
... ctrl_interface=DIR=/var/run/wpa_supplicant GROUP=netdev
... update_config=1
...
... network={
...         ssid=&quot;YOUR_SSID&quot;
...         psk=&quot;YOUR_PASSWORD&quot;
... }
CtrlX,Y,Rtn

### auto start and stop - only do after checking everything works ##
$ crontab -e
... # turn off screen at 21:00
... 00 21 * * * touch /home/pi/pi3d_pictureframe/stop; /opt/vc/bin/tvservice -o
... # turn on screen 07:00
... 00 07 * * * /opt/vc/bin/tvservice -p; /bin/chvt 2; /bin/chvt 1; screen -dmS PICFRAME /usr/bin/python3 /home/pi/pi3d_pictureframe/PictureFrame.py
... # kill any extra python processes that might have crept in
... 00 04 * * * killall python3
... # switch on at start up
... @reboot screen -dmS PICFRAME /usr/bin/python3 /home/pi/pi3d_pictureframe/PictureFrame.py
CtrlX,Y,Rtn
</pre></div>
</div>
<p>In these instructions the &#8221;...&#8221; at the start of lines represents the
fact this is text inside a file and shouldn&#8217;t be actually typed in! Also you
need to change the WiFi credentials to match your router, NB the SSID
and PASSWORD need to be inside quotes. In the picture_getter.py script
you will need to put in the email server, user and password for picking
up images.</p>
</div></blockquote>
</div>
<div class="section" id="pypy">
<h2>pypy<a class="headerlink" href="#pypy" title="Permalink to this headline">¶</a></h2>
<p>Does pi3d work with pypy</p>
<blockquote>
<div><p>pi3d relies on some of the functionality and speed of numpy and this
only really became usable as of pypy-2.2 and the recent versions
of pypy-numpy need more recent versions of pypy (&gt;4.0.1 or 4.4 see below
and bitbucket.org/pypy/numpy)</p>
<p>As at 2017-04-24 I have installed and tested pypy on a Raspberry Pi 3 and
on my ThinkPad i5-2410Mx4core laptop running ubuntu. It pretty much all
works though there are a couple of features of numpy that still don&#8217;t.
Fixes to Font and FixedString will be in pi3d from v.20 (in the develop
branch from now). <em>NB it&#8217;s generally a good idea to do
all this inside virtualenv if you are thinking of using normal python
at the same time</em></p>
<p><strong>On the Laptop thefollowing
steps seemed to get pypy working:</strong></p>
<p>1. in a terminal install pypy from
ubuntu:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">pypy</span>
<span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">pypy</span><span class="o">-</span><span class="n">dev</span>
<span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">pypy</span><span class="o">-</span><span class="n">pkg</span><span class="o">-</span><span class="n">resources</span>
<span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">pypy</span><span class="o">-</span><span class="n">setuptools</span> <span class="c1"># needed for Pillow install from source</span>
</pre></div>
</div>
<p>2. download and install pypy-numpy I did this then changed
to that directory:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">bitbucket</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">pypy</span><span class="o">/</span><span class="n">numpy</span><span class="o">.</span><span class="n">git</span> <span class="o">--</span><span class="n">depth</span> <span class="mi">5</span>
<span class="n">cd</span> <span class="n">numpy</span>
<span class="n">sudo</span> <span class="n">pypy</span> <span class="n">setup</span><span class="o">.</span><span class="n">py</span> <span class="n">install</span>
<span class="c1"># you can then delete this directory</span>
</pre></div>
</div>
<p>3. download Pillow source from <a class="reference external" href="https://pypi.python.org/pypi/Pillow">https://pypi.python.org/pypi/Pillow</a> and
extract it, cd to that directory and install as above:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">Pillow</span><span class="o">-</span><span class="mf">4.</span><span class="n">x</span><span class="o">.</span><span class="n">x</span>
<span class="n">sudo</span> <span class="n">pypy</span> <span class="n">setup</span><span class="o">.</span><span class="n">py</span> <span class="n">install</span>
<span class="c1"># you can then delete this directory</span>
</pre></div>
</div>
<p><strong>On Raspberry Pi raspbian stretch (Aug 2017) pypy v5.6.0 is already installed
however, for some reason, pypy pip has not been, which limits use to
core or pure python modules. Also I found that neither the latest version
of numpy or pillow worked:</strong></p>
<p>1. Get hold of
pip for pypy:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="o">~</span>
<span class="n">sudo</span> <span class="n">curl</span> <span class="o">-</span><span class="n">O</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">bootstrap</span><span class="o">.</span><span class="n">pypa</span><span class="o">.</span><span class="n">io</span><span class="o">/</span><span class="n">get</span><span class="o">-</span><span class="n">pip</span><span class="o">.</span><span class="n">py</span>
<span class="n">sudo</span> <span class="n">pypy</span> <span class="n">get</span><span class="o">-</span><span class="n">pip</span><span class="o">.</span><span class="n">py</span>
<span class="n">pypy</span> <span class="o">-</span><span class="n">mpip</span> <span class="n">install</span> <span class="o">-</span><span class="n">U</span> <span class="n">wheel</span>
</pre></div>
</div>
<p>2. Pip install numpy
NB using <cite>pypy -mpip ..</cite>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">pypy</span> <span class="o">-</span><span class="n">mpip</span> <span class="n">install</span> <span class="n">cython</span>
<span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">pypy</span><span class="o">-</span><span class="n">dev</span>
<span class="n">sudo</span> <span class="n">pypy</span> <span class="o">-</span><span class="n">mpip</span> <span class="n">install</span> <span class="n">numpy</span><span class="o">==</span><span class="mf">1.12</span><span class="o">.</span><span class="mi">1</span>
</pre></div>
</div>
<p>3. Pip install PIL
agian <cite>pypy -mpip ..</cite>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">libjpeg</span><span class="o">-</span><span class="n">dev</span> <span class="c1">#zlib1g-dev libpng12-dev libfreetype6-dev # seemed to cause errors</span>
<span class="n">sudo</span> <span class="n">pypy</span> <span class="o">-</span><span class="n">mpip</span> <span class="n">install</span> <span class="n">Pillow</span><span class="o">==</span><span class="mf">4.0</span><span class="o">.</span><span class="mi">0</span>
</pre></div>
</div>
<p><strong>Prior to stretch (i.e. jessie) I found that the pypy installed
is v4.0 and pypy-numpy demands &gt; v4.4 so this is what I did
(NB I noticed subsequently that there is an option to install numpypy
for pypy4.0.1 - see the bitbucket/pypy/numpy page if you want to try this
first):</strong></p>
<p>1. download and unzip the latest stable release of pypy for raspbian. As
at now <code class="docutils literal"><span class="pre">https://bitbucket.org/pypy/pypy/downloads/pypy2-v5.7.1-linux-armhf-raspbian.tar.bz2</span></code>
I put this as <code class="docutils literal"><span class="pre">/home/pi/pypy2-v5.7.1-linux-armhf-raspbian/</span></code></p>
<p>2. to save confusion I overwrote the symlink to the previously installed
pypy-4.0. In a terminal:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">ln</span> <span class="o">-</span><span class="n">s</span> <span class="o">-</span><span class="n">f</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">pi</span><span class="o">/</span><span class="n">pypy2</span><span class="o">-</span><span class="n">v5</span><span class="o">.</span><span class="mf">7.1</span><span class="o">-</span><span class="n">linux</span><span class="o">-</span><span class="n">armhf</span><span class="o">-</span><span class="n">raspbian</span><span class="o">/</span><span class="n">pypy</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">pypy</span>
</pre></div>
</div>
<p>3. I tried the three apt-get install instructions as per ubuntu but
only pypy-dev seemed to work. It wasn&#8217;t clear how to use pip with pypy but
in the end I did the following in a terminal:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">pi</span><span class="o">/</span><span class="n">pypy2</span><span class="o">-</span><span class="n">v5</span><span class="o">.</span><span class="mf">7.1</span><span class="o">-</span><span class="n">linux</span><span class="o">-</span><span class="n">armhf</span><span class="o">-</span><span class="n">raspbian</span><span class="o">/</span>
<span class="n">pypy</span> <span class="o">-</span><span class="n">m</span> <span class="n">ensurepip</span>
<span class="nb">bin</span><span class="o">/</span><span class="n">pip</span> <span class="n">install</span> <span class="o">-</span><span class="n">U</span> <span class="n">pip</span> <span class="n">wheel</span>
<span class="nb">bin</span><span class="o">/</span><span class="n">pip</span> <span class="n">install</span> <span class="n">pkg_resources</span>
</pre></div>
</div>
<p>I think there was an error but <code class="docutils literal"><span class="pre">import</span> <span class="pre">pkg_resources</span></code> seemed to work
after this.</p>
<p>4. At one stage I installed all of the following, many may not be needed but some
might. You could try without first I suppose, but it didn&#8217;t take too long.:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">gcc</span> <span class="n">make</span> <span class="n">libffi</span><span class="o">-</span><span class="n">dev</span> <span class="n">pkg</span><span class="o">-</span><span class="n">config</span> <span class="n">libz</span><span class="o">-</span><span class="n">dev</span> <span class="n">libbz2</span><span class="o">-</span><span class="n">dev</span> \
<span class="n">libsqlite3</span><span class="o">-</span><span class="n">dev</span> <span class="n">libncurses</span><span class="o">-</span><span class="n">dev</span> <span class="n">libexpat1</span><span class="o">-</span><span class="n">dev</span> <span class="n">libssl</span><span class="o">-</span><span class="n">dev</span> <span class="n">libgdbm</span><span class="o">-</span><span class="n">dev</span> <span class="n">tk</span><span class="o">-</span><span class="n">dev</span> \
<span class="n">libgc</span><span class="o">-</span><span class="n">dev</span> <span class="n">python</span><span class="o">-</span><span class="n">cffi</span> <span class="n">liblzma</span><span class="o">-</span><span class="n">dev</span>
</pre></div>
</div>
<p>5. For Pillow to work
you need these (that&#8217;s a &#8216;one&#8217; in zlib1g-dev by the way):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">libjpeg</span><span class="o">-</span><span class="n">dev</span> <span class="n">zlib1g</span><span class="o">-</span><span class="n">dev</span> <span class="n">libpng12</span><span class="o">-</span><span class="n">dev</span> <span class="n">libfreetype6</span><span class="o">-</span><span class="n">dev</span>
</pre></div>
</div>
<p>6. Download, extract and install pypy-numpy.
I used git, as with ubuntu above.:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">bitbucket</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">pypy</span><span class="o">/</span><span class="n">numpy</span><span class="o">.</span><span class="n">git</span> <span class="o">--</span><span class="n">depth</span> <span class="mi">5</span>
<span class="n">cd</span> <span class="n">numpy</span>
<span class="n">sudo</span> <span class="n">pypy</span> <span class="n">setup</span><span class="o">.</span><span class="n">py</span> <span class="n">install</span>
<span class="c1"># you can then delete this directory</span>
</pre></div>
</div>
<p>7. Pip install
Pillow:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">pi</span><span class="o">/</span><span class="n">pypy2</span><span class="o">-</span><span class="n">v5</span><span class="o">.</span><span class="mf">7.1</span><span class="o">-</span><span class="n">linux</span><span class="o">-</span><span class="n">armhf</span><span class="o">-</span><span class="n">raspbian</span><span class="o">/</span>
<span class="nb">bin</span><span class="o">/</span><span class="n">pip</span> <span class="n">install</span> <span class="n">Pillow</span>
</pre></div>
</div>
<p>For both these installations you will need to pip install pi3d (using the
pypy pip) or download (or git clone) pi3d and use
<code class="docutils literal"><span class="pre">sys.path.insert(1,</span> <span class="pre">'/home/pi/pi3d')</span></code> before <code class="docutils literal"><span class="pre">import</span> <span class="pre">pi3d</span></code>. The
pi3d_demo files do this automatically.</p>
<p>At the moment the PexParticles and Pong demos fail mainly due to non-implemented
features of numpy (einsum, interp, remainder and outer). The speed benefit
of running pypy won&#8217;t improve the GPU functionality or the numpy calculations
but in some areas where there is a lot of looping in the python code there
could be gains (The CollisionBalls.py demo for instance).</p>
</div></blockquote>
</div>
<div class="section" id="diy-environments">
<h2>DIY environments<a class="headerlink" href="#diy-environments" title="Permalink to this headline">¶</a></h2>
<div class="section" id="cube">
<h3>Cube<a class="headerlink" href="#cube" title="Permalink to this headline">¶</a></h3>
<p>How can I make my own EnvironmentCube images using pictures of my
garden or school playground?</p>
<blockquote>
<div><p>Option 1. Using an EnvironmentCube (as the question says) but see
below for using a Sphere, which is probably easier.</p>
<p>There are lots of ways of doing this and different software as well
as special cameras. However this is the method I have followed using
freely available software: gimp and blender (running on a &#8216;normal&#8217;
computer rather than the pi at this stage).</p>
<p>The first half of the job is to get a set of images into a &#8216;seamless&#8217;
band. Obviously you need to have taken a set of pictures that overlap
25% to 50%. In gimp make a new image that is higher and wider than
you will need to paste all the images side by side. You will need to
have the same image repeated at the left end and the right end.</p>
<p>Open each image in gimp then copy it, go to the new &#8216;wide strip&#8217;
image and paste as new layer. Use the four headed arrow to position
each layer so it &#8216;joins up&#8217;. When you put the duplicate left most
image at the right end you need to make sure that it is at exactly
the same vertical position as it is on the left.</p>
<p>Working down from the top layer add layer masks (default white, full
opacity) then using gradient fill tool make the mask fade from
transparent to opaque across the overlapping portion. You might need
to slightly rotate some images to make them join up nicely from one
side to the other.</p>
<p>When it looks perfect (!) merge the layers down then crop the image
so there are no gaps at the top and bottom and so the left and right
edges join seamlessly. You will probably have to zoom to maximum and
choose an easily identifiable pixel. The rectangular selection tool
in gimp allows the edges to be dragged to fine tune it. Export the
image to jpg or png possibly after reducing to a reasonable size. Have
some suitable sky only image to patch into the top of the sphere you
will create in blender...</p>
<p>I used blender 2.69, it&#8217;s not a trivial application if you&#8217;ve not used
it before and it might take a bit of effort to figure out what I&#8217;m
referring to [tab] means tab key, otherwise it&#8217;s probably a menu
item or an icon in the right hand. Lots of youtube videos to look at.
In blender:</p>
<p>1. [del] delete the
startup cube</p>
<p>2. <code class="docutils literal"><span class="pre">Add</span> <span class="pre">Mesh</span> <span class="pre">UV</span> <span class="pre">Sphere</span></code>, on left tools
set <code class="docutils literal"><span class="pre">Shading</span> <span class="pre">Smooth</span></code></p>
<p>3. [s] to scale up
to about 10x</p>
<p>4. [tab] to edit mode [a] to deselect all vertices. R-click on top
vertex the Ctrl-numpad+ to select vertices down to about 45 degrees
north (or use [b] and box select) [del] delete vertices. You should
now have a sphere with the top cut off</p>
<p>5. [tab] back to object mode then create another sphere at the same
location but scale it up very slightly bigger and chop off the bottom
but so they overlap just a little.</p>
<p>6. [tab] back to object mode then <code class="docutils literal"><span class="pre">Add</span> <span class="pre">Empty</span> <span class="pre">Cube</span></code> at the same location
(NB if you accidentally left click on the view window you will move
the starting point marker where new things appear). You should be able
to zoom in with the mouse wheel and see this cube inside the spheres.</p>
<p>7. still in object mode right click to select the bottom (inner and larger)
sphere. The edge should go yellow to indicate it&#8217;s been selected.</p>
<p>8. on the right properties window click the Materials icon (CofG circle
4th from right), then + new.</p>
<p>9. then click the Textures icon (red/white check 3rd from right),
then + new, <code class="docutils literal"><span class="pre">Type</span> <span class="pre">Image</span> <span class="pre">or</span> <span class="pre">movie</span></code>, <code class="docutils literal"><span class="pre">Image</span> <span class="pre">New</span></code> browse to the wide horizon
image you made, <code class="docutils literal"><span class="pre">Mapping</span> <span class="pre">Projection</span> <span class="pre">Tube</span></code></p>
<p>10. still in object mode right click on the top sphere, add material and
texture exactly as for the bottom sphere but select the patch of sky
image mentioned above and choose <code class="docutils literal"><span class="pre">Mapping</span> <span class="pre">Projection</span> <span class="pre">Flat</span></code></p>
<p>11. in object mode right click on the Empty Cube and add a new Texture (you
should see a reduced list of options so it&#8217;s 2nd from right in the list)</p>
<p>12. select under <code class="docutils literal"><span class="pre">Type</span> <span class="pre">Environment</span> <span class="pre">Map</span></code> then under <code class="docutils literal"><span class="pre">Environment</span> <span class="pre">Map</span> <span class="pre">Static</span></code>,
<code class="docutils literal"><span class="pre">Mapping</span> <span class="pre">Cube</span></code> and <code class="docutils literal"><span class="pre">Viewpoint</span> <span class="pre">Object</span>&#160; <span class="pre">Empty</span></code></p>
<p>13. in the properties icons select render (camera left most) then under
Render press the render button. This should flash up a series of six
smaller images then go black!</p>
<p>14. re-select the Texture icon (all of these steps should have the Empty
Cube as the selected object) and the little down arrow under Environment
Map should produce a drop-down menu with an option to save the image.</p>
<p>The texture can then be used in pi3d with EnvironmentMap type BLENDER. However
there will be a sharp line where the edge of the bottom sphere fell. You can
smooth this out using clone, repair, blur and blend tools in gimp; be
careful not to blur the boundaries between the six images.</p>
</div></blockquote>
</div>
<div class="section" id="sphere">
<h3>Sphere<a class="headerlink" href="#sphere" title="Permalink to this headline">¶</a></h3>
<p>How do I make an Environment Sphere (such as can use the Photo Sphere
images created by later versions of Android)</p>
<blockquote>
<div><p>First you need an image very much like the one outlined in the previous
question. If you have the software on your phone or tablet to do a
Photo Sphere that&#8217;s going to be a lot easier but you can do something
similar with a series of panoramas as modern cameras can make. The
image needs to be twice as wide as it is high using a standard cylindrical
projection <a class="reference external" href="http://en.wikipedia.org/wiki/Equirectangular_projection">http://en.wikipedia.org/wiki/Equirectangular_projection</a></p>
<p>This image is used for a Texture uv mapped to a standard pi3d.Sphere
but the Texture needs to have the argument <code class="docutils literal"><span class="pre">flip=True</span></code> and the Sphere
needs the argument <code class="docutils literal"><span class="pre">invert=True</span></code></p>
<p>If the same image is used as the reflection with <code class="docutils literal"><span class="pre">uv_reflect</span></code> or
<code class="docutils literal"><span class="pre">mat_reflect</span></code> shaders then the correct part of the scenery will be
rendered - i.e. behind the camera and transposed left-right, see
demo <code class="docutils literal"><span class="pre">EnvironmentSphere.py</span></code>.</p>
</div></blockquote>
</div>
</div>
<div class="section" id="pickling">
<h2>pickling<a class="headerlink" href="#pickling" title="Permalink to this headline">¶</a></h2>
<p>How can I speed up loading Models. Even quite low polygon counts
seem to take ages on the Raspberry Pi</p>
<blockquote>
<div><p>Thanks to Avishay <a class="reference external" href="https://github.com/avishorp">https://github.com/avishorp</a> it is possible to use
the python pickle functionality to serialise pi3d Shapes including
Model.</p>
<p>There is an example on github.com/pi3d/pi3d_demos
LoadModelPickle.py which shows the process but basically:</p>
<blockquote>
<div><p>load the models once normally, create a file (has to be
binary for python3) to write to, then <code class="docutils literal"><span class="pre">pickle.dump(mymodel,</span> <span class="pre">f)</span></code></p>
<p>subsequently open the file to read from and <code class="docutils literal"><span class="pre">mymodel</span> <span class="pre">=</span> <span class="pre">pickle.read(f)</span></code>
the loaded file will have any required Textures included automatically
including bump and reflection maps. However the shader will still
need to be set with <code class="docutils literal"><span class="pre">set_shader()</span></code></p>
</div></blockquote>
<p>Loading from a pickle file is significantly faster than parsing a
wavefront obj file but (because of the less efficient image compression)
the disk space used will be much higher.</p>
</div></blockquote>
</div>
<div class="section" id="strings">
<h2>Strings<a class="headerlink" href="#strings" title="Permalink to this headline">¶</a></h2>
<div class="section" id="quick-change">
<h3>quick change<a class="headerlink" href="#quick-change" title="Permalink to this headline">¶</a></h3>
<p>How to have lots of rapidly changing text on the screen (such as location
game-status readouts etc) whithout having to create new String objects
all the time (with associated processor load)</p>
<blockquote>
<div><p>This can be done using the String.quick_change() method.</p>
<p>When you first create the string you need to make it big enough to
fit in any additional characters you may send to quick_change()
subsequently. At the moment it doesn&#8217;t cope with multi-line Strings.</p>
<p>There is an example in pi3d_demos/ForestQuickNumbers.py</p>
</div></blockquote>
<p>Why do I get an error when I try call the quick_change()
method in my program.</p>
<blockquote>
<div>If you get <code class="docutils literal"><span class="pre">AttributeError:</span> <span class="pre">'Buffer'</span> <span class="pre">object</span> <span class="pre">has</span> <span class="pre">no</span> <span class="pre">attribute</span> <span class="pre">'vbuf'</span></code>
then this could be because you are calling quick_change() before the
first draw() of the String object. Unfortunately you can&#8217;t do this
(as at pi3d v2.10) and you will have to alter your code to ensure the
draw happens before the change.</div></blockquote>
</div>
<div class="section" id="fixedstring">
<h3>FixedString<a class="headerlink" href="#fixedstring" title="Permalink to this headline">¶</a></h3>
<p>How to have a large amount of text without creating hundreds of extra
polygons for the gpu to render?</p>
<blockquote>
<div>The String object has a little rectangle for each letter, each of
which needs four vertices and two triangles. If the text does not
need to be changed then it is better to use the FixedString class.
The object inherits from Texture with the provided text drawn onto it.
It also creates a simple sprite with four vertices and two triangles
that can be used to draw the texture. There are filters that can
produce effects such as blurring, outlining and normal map generation.</div></blockquote>
</div>
<div class="section" id="pointtext">
<h3>PointText<a class="headerlink" href="#pointtext" title="Permalink to this headline">¶</a></h3>
<p>I want lots of text changing in real-time, scrolling, rotating, fading
or changing colour.</p>
<blockquote>
<div>For complicated things like this then the PointText class should be used
(with TextBlock components) see the demo StringMulti.py</div></blockquote>
</div>
<div class="section" id="shadow">
<h3>Shadow<a class="headerlink" href="#shadow" title="Permalink to this headline">¶</a></h3>
<p>How can I make my text show up against different coloured backgrounds (such
as when displaying the score as 2D text)</p>
<blockquote>
<div><p>There are two ways to do this in pi3d. The first is to define a background_color
in the Font or FixedString with a low alpha value (say 20 out of 255).
This will produce partially transparrent background for your letters which
will be a rectangle if you are using a FixedString but will be uneven
edged if you are using a normal String with Font. If you set the alpha to
zero you will end up with a subtle line around the outside of each letter,
which may be enough.</p>
<p>To get a larger outline around letters you can specify a shadow_radius and
a shadow RGBA value (default black with no transparrency). This produces
a gaussian blurred version &#8216;underneath&#8217; each letter. See the Shapes demo
for how this might look.</p>
</div></blockquote>
</div>
</div>
<div class="section" id="normal-map-generation">
<h2>Normal Map generation<a class="headerlink" href="#normal-map-generation" title="Permalink to this headline">¶</a></h2>
<p>I have a low polygon model that I want to appear more detailed. I know I
can do that if I have a normal map to supply to the <code class="docutils literal"><span class="pre">.._bump</span></code> or <code class="docutils literal"><span class="pre">.._reflect</span></code>
shaders. Is there a way to generate these automatically.</p>
<blockquote>
<div><p>Yes. If you simply use the same image file for the texture and the
normal map then this will alter the lighting of the surface. However this
will often give rather strange effects due to the interpretation of surface
normals from RGB values. To get a better result you can create a version
that uses the lightness of the image as a height map, for instance in
the Water.py demo:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">shapeimg</span> <span class="o">=</span> <span class="n">pi3d</span><span class="o">.</span><span class="n">Texture</span><span class="p">(</span><span class="s2">&quot;textures/straw1.jpg&quot;</span><span class="p">)</span>
<span class="n">shapebump</span> <span class="o">=</span> <span class="n">pi3d</span><span class="o">.</span><span class="n">Texture</span><span class="p">(</span><span class="s2">&quot;textures/straw1.jpg&quot;</span><span class="p">,</span> <span class="n">normal_map</span><span class="o">=-</span><span class="mf">6.0</span><span class="p">)</span>
</pre></div>
</div>
<p>The size and sign of the normal_map argument can be used to compensate
for the contrast and positive/negative nature of the image.</p>
<p>Alternatively you can make a copy of the colour texture image and edit
it with GIMP (or similar) to make a greyscale version that matches the
surface geometry you want.</p>
</div></blockquote>
</div>
<div class="section" id="texture-animation">
<h2>Texture animation<a class="headerlink" href="#texture-animation" title="Permalink to this headline">¶</a></h2>
<p>Is it possible to change a texture every frame at a reasonable frame
rate? i.e. for displaying a video, a feed from a web cam or an
image manipulation program such as OpenCV, Scipy or numpy?</p>
<blockquote>
<div><p>This became much more feasible after v1.4 and more so after v2.1
The Texture class now accepts a numpy array (size (H,W,N) where N
is 3 for RGB or 4 for RGBA), remember C arrays are row,col,pixel)</p>
<p>There is also a method Texture.update_ndarray(new_array) that can
efficiently switch the image to the new array. See the demo
<code class="docutils literal"><span class="pre">VideoWalk.py</span></code> which maps a movie onto a shape using ffmpeg.</p>
<p>A much faster system can be used on the Raspberry Pi that utilises the
C code used in the demos in /opt/vc/src/hello_pi. This is tricky programming
but a working version has been created by &#64;swhner
<a class="reference external" href="https://github.com/swehner/foos/blob/opengl_replay/foos/ui/opengl_replay.py">https://github.com/swehner/foos/blob/opengl_replay/foos/ui/opengl_replay.py</a>
and <a class="reference external" href="https://github.com/swehner/foos/blob/opengl_replay/egl_replay/video_helper.c">https://github.com/swehner/foos/blob/opengl_replay/egl_replay/video_helper.c</a></p>
</div></blockquote>
</div>
<div class="section" id="profiling">
<h2>Profiling<a class="headerlink" href="#profiling" title="Permalink to this headline">¶</a></h2>
<p>How to profile code to find where the bottlenecks are? For example
to find if it&#8217;s worth doing something complicated with numpy or &#8216;blitting&#8217;
small areas of the screen as in the NumpyBalls demo?</p>
<blockquote>
<div><p>The python profiler cProfile is very easy to use but I have found
it struggles to find directories from the code and gives quirky
information unless I do something like:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ cd ~/pi3d_demos
$ python -m cProfile ~/pi3d_demos/NumpyBalls.py &gt; result.txt
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="desktop-or-laptop">
<h2>Desktop or laptop<a class="headerlink" href="#desktop-or-laptop" title="Permalink to this headline">¶</a></h2>
<p>Is it possible to use pi3d on my laptop or desktop computer
ideally running windows?</p>
<blockquote>
<div><p>If your computer has a suitable graphics card then you should be
able to do this.</p>
<p><strong>Raspbian Pixel</strong> is probably the easiest to set up from scratch and most
closely matches behaviour on the Raspberry Pi, if you are happy booting
onto a USB stick see <a class="reference external" href="http://pi3d.github.com/html/ReadMe.html#setup-on-desktop-and-laptop-machines">ReadMe Linux</a></p>
<p><strong>windows</strong> requires a version of pi3d v2.0 or later see <a class="reference external" href="http://pi3d.github.com/html/ReadMe.html#windows">ReadMe Windows</a></p>
<p><strong>linux</strong> is more similar to the Raspberry Pi, also see <a class="reference external" href="http://pi3d.github.com/html/ReadMe.html#setup-on-desktop-and-laptop-machines">ReadMe Linux</a></p>
<p><strong>mac</strong> ought to be possible following a very similar procedure to
linux but I havn&#8217;t tried (let me know if you do!)</p>
<p>On windows or mac it is also possible to use something like VMWare:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>Setup:

VMWare Client
3d Accel.. activated!
LinuxMint Installation (Ubundu-based and Debian base version works)

very important
    mesa-utils-extra
    python-numpy
and the rest as described in the Pi3D documentation

Important: pi3d scripts must be started with sudo

e.g. sudo python ./Pi3D2.py

In the VM it does not run very smooth, but it works without errors.

After testing this setup  I&#39;ve installed the setup to a partition... runs like a charm :-)
</pre></div>
</div>
<p>comments by &#64;hesspet in groups.google.com</p>
</div></blockquote>
</div>
<div class="section" id="android">
<h2>Android<a class="headerlink" href="#android" title="Permalink to this headline">¶</a></h2>
<p>Is is possible to run pi3d on my Android phone or tablet which uses
a chip and operating system very similar to the Raspberry Pi?</p>
<blockquote>
<div>Is is possible; but you have to compile an apk package using
python-for-android from a linux machine. There are instructions here
<a class="reference external" href="http://pi3d.github.io/html/AndroidUse.html">http://pi3d.github.io/html/AndroidUse.html</a></div></blockquote>
</div>
<div class="section" id="targetting">
<h2>Targetting<a class="headerlink" href="#targetting" title="Permalink to this headline">¶</a></h2>
<div class="section" id="identify-what-s-in-front-of-the-camera">
<h3>Identify what&#8217;s in front of the Camera<a class="headerlink" href="#identify-what-s-in-front-of-the-camera" title="Permalink to this headline">¶</a></h3>
<p>How to find the name of the object in the camera&#8217;s target (pi3D 3d world)
example:https://www.youtube.com/watch?v=0u91pcNXtcI&amp;feature=autoshare
sun, world, astroid123?</p>
<blockquote>
<div><p>One approach would be to look at the size of the angle between the
direction to each possible target and the direction the camera is pointing.
You would then choose objects where that angle was smaller than a threshold
then choose the nearest if more than one. Say in pi3d_demos.ForestWalk.py
you had kept a dict of different objects as obj_dict, you could add a
print() when you press the &#8216;h&#8217; key:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">obj_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;monument&#39;</span><span class="p">:</span><span class="n">monument</span><span class="p">,</span> <span class="s1">&#39;trees1&#39;</span><span class="p">:</span><span class="n">mytrees1</span><span class="p">,</span> <span class="s1">&#39;trees2&#39;</span><span class="p">:</span><span class="n">mytrees2</span><span class="p">,</span> <span class="s1">&#39;trees3&#39;</span><span class="p">:</span><span class="n">mytrees3</span><span class="p">}</span>
<span class="n">THRESHOLD</span> <span class="o">=</span> <span class="mf">0.95</span>
<span class="o">...</span>
  <span class="k">elif</span> <span class="n">k</span> <span class="o">==</span> <span class="nb">ord</span><span class="p">(</span><span class="s1">&#39;h&#39;</span><span class="p">):</span>
    <span class="n">nearest</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">target_name</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">for</span> <span class="n">o_name</span> <span class="ow">in</span> <span class="n">obj_dict</span><span class="p">:</span>
      <span class="n">o</span> <span class="o">=</span> <span class="n">obj_dict</span><span class="p">[</span><span class="n">o_name</span><span class="p">]</span>
      <span class="n">v1</span> <span class="o">=</span> <span class="n">o</span><span class="o">.</span><span class="n">unif</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="n">CAMERA</span><span class="o">.</span><span class="n">eye</span> <span class="c1"># numpy vector from camera to object</span>
      <span class="n">dist</span> <span class="o">=</span> <span class="p">(</span><span class="n">v1</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">**</span> <span class="mf">0.5</span>
      <span class="n">v1</span> <span class="o">/=</span> <span class="n">dist</span> <span class="c1"># divide by length</span>
      <span class="n">v2</span> <span class="o">=</span> <span class="n">CAMERA</span><span class="o">.</span><span class="n">get_direction</span><span class="p">()</span> <span class="c1"># already length = 1</span>
      <span class="n">cos_angle</span> <span class="o">=</span> <span class="n">v1</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">v2</span><span class="p">)</span> <span class="c1"># 1 straigt at it, 0 at right angles, -1 opposite direction</span>
      <span class="k">if</span> <span class="n">cos_angle</span> <span class="o">&gt;=</span> <span class="n">THRESHOLD</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">nearest</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">dist</span> <span class="o">&lt;</span> <span class="n">nearest</span><span class="p">:</span>
          <span class="n">nearest</span> <span class="o">=</span> <span class="n">dist</span>
          <span class="n">target_name</span> <span class="o">=</span> <span class="n">o_name</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;nothing&#39;</span> <span class="k">if</span> <span class="n">target_name</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">target_name</span><span class="p">)</span>
</pre></div>
</div>
<p>However this only works for smallish objects. If you want to see if the
cross-hairs are hitting the Earth on the meteorize game then you would
either have to include a size factor into the obj_dict above instead of
using an overall threshold i.e.:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">obj_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;monument&#39;</span><span class="p">:[</span><span class="n">monument</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
    <span class="s1">&#39;trees1&#39;</span><span class="p">:[</span><span class="n">mytrees1</span><span class="p">,</span><span class="mi">15</span><span class="p">],</span>
    <span class="s1">&#39;trees2&#39;</span><span class="p">:[</span><span class="n">mytrees2</span><span class="p">,</span><span class="mi">20</span><span class="p">],</span>
    <span class="s1">&#39;trees3&#39;</span><span class="p">:[</span><span class="n">mytrees3</span><span class="p">,</span> <span class="mi">20</span><span class="p">]}</span>
<span class="n">o</span> <span class="o">=</span> <span class="n">obj_dict</span><span class="p">[</span><span class="n">o_name</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="n">sz</span> <span class="o">=</span> <span class="n">obj_dict</span><span class="p">[</span><span class="n">o_name</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
<span class="k">if</span> <span class="n">cos_angle</span> <span class="o">&gt;</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="n">sz</span> <span class="o">/</span> <span class="n">dist</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.5</span>
</pre></div>
</div>
<p>Though this method would have issues with large objects such as the merged
&#8216;tree&#8217; objects in ForestWalk, where it is possible to be &#8216;inside&#8217; the
object.</p>
<p>Or look at each face of the object and see if the vector intercepts each
triangle - but this would be very slow. See the Pong demo and the
ElevationMap.clashTest() method.</p>
<p>Finally a fairly efficient but technical method would be a variation of
the Clashtest system using glScissor to draw a single pixel of each object
to an offscreen texture with different RGB values for each then checking
what if any had been drawn.</p>
</div></blockquote>
</div>
<div class="section" id="bullets">
<h3>Bullets<a class="headerlink" href="#bullets" title="Permalink to this headline">¶</a></h3>
<p>How to create bullets and shoot targets?
(like counter strike)</p>
<blockquote>
<div>The bullets in Counter Strike just look like streaks of light with some
smoke so the best way is probably something like the bullets in DogFight.
This uses two Plane objects merged at 90 degrees to each other with a
series of images that can be mapped onto them in sequence (there are two
sets of guns on the Aeroplane which is why there are four Planes). How
you animate the target being shot depends on the effect you want. In the
meteorize game I use a part transparent texture and scale the meteors up
so they look to be bursting soap bubbles.</div></blockquote>
</div>
<div class="section" id="laser-sight">
<h3>Laser sight<a class="headerlink" href="#laser-sight" title="Permalink to this headline">¶</a></h3>
<p>How to create a
laser point for gun?</p>
<blockquote>
<div><p>This is the kind of thing you can do.
For example to modify ForestWalk.py to include a laser dot:</p>
<p>1.Copy the shaders you want to get lasers on to the pi3d_demos/shaders
directory and rename i.e. uv_bump_laserdot.vs, uv_bump_laserdot.fs</p>
<p>2.edit the fragment shaders i.e. uv_bump_laserdot.fs and add the
two lines:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1">#include std_bump.inc</span>
  <span class="nb">float</span> <span class="n">radial</span> <span class="o">=</span> <span class="n">distance</span><span class="p">(</span><span class="n">vec2</span><span class="p">(</span><span class="n">gl_FragCoord</span><span class="p">),</span> <span class="n">unif</span><span class="p">[</span><span class="mi">15</span><span class="p">]</span><span class="o">.</span><span class="n">xy</span><span class="p">);</span> <span class="o">//</span> <span class="mi">1</span> <span class="o">---</span> <span class="n">distance</span> <span class="kn">from</span> <span class="nn">centre</span> <span class="n">of</span> <span class="n">screen</span>
  <span class="n">texc</span><span class="o">.</span><span class="n">rgb</span> <span class="o">+=</span> <span class="n">vec3</span><span class="p">(</span><span class="mf">5.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.0</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">dist</span> <span class="o">*</span> <span class="n">radial</span><span class="p">);</span> <span class="o">//</span> <span class="mi">2</span> <span class="o">---</span> <span class="n">increase</span> <span class="n">R</span><span class="p">,</span> <span class="n">decrease</span> <span class="n">GB</span> <span class="n">reduce</span> <span class="n">size</span> <span class="ow">in</span> <span class="n">distance</span>
  <span class="n">gl_FragColor</span> <span class="o">=</span>  <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">ffact</span><span class="p">)</span> <span class="o">*</span> <span class="n">texc</span> <span class="o">+</span> <span class="n">ffact</span> <span class="o">*</span> <span class="n">vec4</span><span class="p">(</span><span class="n">unif</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">unif</span><span class="p">[</span><span class="mi">5</span><span class="p">][</span><span class="mi">1</span><span class="p">]);</span> <span class="o">//</span> <span class="o">------</span> <span class="n">combine</span> <span class="n">using</span> <span class="n">factors</span>
</pre></div>
</div>
<p>2.change ForestWalk.py
to use the new shaders:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1"># load shader</span>
<span class="n">shader</span> <span class="o">=</span> <span class="n">pi3d</span><span class="o">.</span><span class="n">Shader</span><span class="p">(</span><span class="s2">&quot;shaders/uv_bump_laserdot&quot;</span><span class="p">)</span>
<span class="o">...</span>
</pre></div>
</div>
<p>3.change ForestWalk.py to add the x, y location of the screen midpoint to
each Shape that uses the new shaders:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">...</span>
<span class="n">mymap</span><span class="o">.</span><span class="n">set_fog</span><span class="p">(</span><span class="o">*</span><span class="n">FOG</span><span class="p">)</span>
<span class="n">mymap</span><span class="o">.</span><span class="n">unif</span><span class="p">[</span><span class="mi">45</span><span class="p">:</span><span class="mi">47</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">DISPLAY</span><span class="o">.</span><span class="n">width</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">,</span> <span class="n">DISPLAY</span><span class="o">.</span><span class="n">height</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">]</span> <span class="c1">#or use mymap.set_2d_size(DISPLAY.width / 2.0, DISPLAY.height / 2.0)</span>
</pre></div>
</div>
<p>You could take an alternative route if you are using the obj_dict idea
from above. In that case you could simply draw the laser dot in the middle
of the screen (i.e. using a Camera(is_3d=False..)) and scale the dot
according to distance to the target. The disadvantage is that the dot
wouldn&#8217;t scale correctly on very large objects such as the terrain.</p>
</div></blockquote>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Frequently Asked Questions</a><ul>
<li><a class="reference internal" href="#graphics-memory">Graphics Memory</a><ul>
<li><a class="reference internal" href="#assert-s-0">assert s &gt;= 0</a></li>
<li><a class="reference internal" href="#egl-no-surface">EGL_NO_SURFACE</a></li>
<li><a class="reference internal" href="#start-then-shut-down">Start then shut down</a></li>
</ul>
</li>
<li><a class="reference internal" href="#tkinter-tclerror">_tkinter.TclError</a></li>
<li><a class="reference internal" href="#pistore-install">PiStore install</a><ul>
<li><a class="reference internal" href="#taking-too-long">taking too long</a></li>
<li><a class="reference internal" href="#doing-more-with-pistore-installation">Doing more with PiStore installation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#glx-dri2-not-supported-or-failed-to-authenticate">GLX DRI2 not supported or failed to authenticate</a></li>
<li><a class="reference internal" href="#runtime-errors">Runtime errors</a><ul>
<li><a class="reference internal" href="#crashing">Crashing</a></li>
<li><a class="reference internal" href="#white-screen">white screen</a></li>
<li><a class="reference internal" href="#black-screen">black screen</a></li>
<li><a class="reference internal" href="#only-background">only background</a></li>
<li><a class="reference internal" href="#unlit-silhouettes">unlit silhouettes</a></li>
<li><a class="reference internal" href="#mouse-not-working">Mouse not working</a></li>
<li><a class="reference internal" href="#cbreak-error">cbreak error</a></li>
<li><a class="reference internal" href="#scrambled-terminal-after-ctrl-c-or-crash">scrambled terminal after Ctrl-C or crash</a></li>
<li><a class="reference internal" href="#no-video-output-running-remotely">No video output running remotely</a></li>
</ul>
</li>
<li><a class="reference internal" href="#optional-arguments">Optional arguments</a></li>
<li><a class="reference internal" href="#blending">Blending</a></li>
<li><a class="reference internal" href="#materials">Materials</a></li>
<li><a class="reference internal" href="#joysticks-etc">joysticks etc</a></li>
<li><a class="reference internal" href="#d-models">3D models</a><ul>
<li><a class="reference internal" href="#making-3d-models">Making 3D models</a></li>
<li><a class="reference internal" href="#imported-model-doesn-t-appear">Imported model doesn&#8217;t appear</a></li>
</ul>
</li>
<li><a class="reference internal" href="#d-images">2D images</a><ul>
<li><a class="reference internal" href="#how-to-use-2d-images">How to use 2D images</a></li>
<li><a class="reference internal" href="#nearness-of-2d-relative-to-3d">nearness of 2D relative to 3D</a></li>
<li><a class="reference internal" href="#nearness-of-pointtext-and-textblock-relative-to-other-2d-objects">Nearness of PointText and TextBlock relative to other 2D objects</a></li>
<li><a class="reference internal" href="#pointtext-stops-working-if-too-many-textblocks-added">PointText stops working if too many TextBlocks added</a></li>
<li><a class="reference internal" href="#default-fog-distance">Default fog distance</a></li>
<li><a class="reference internal" href="#pixel-perfect">Pixel perfect</a></li>
<li><a class="reference internal" href="#anti-aliasing">anti-aliasing</a></li>
<li><a class="reference internal" href="#texture-blurring">Texture blurring</a></li>
<li><a class="reference internal" href="#display-size-greater-than-2048">Display size greater than 2048</a></li>
</ul>
</li>
<li><a class="reference internal" href="#log-messages">Log messages</a><ul>
<li><a class="reference internal" href="#how-to-use-logging">How to use logging</a></li>
<li><a class="reference internal" href="#printed-messages-not-visible-on-raspberry-pi">Printed messages not visible on Raspberry Pi</a></li>
</ul>
</li>
<li><a class="reference internal" href="#moving-shapes-together">Moving shapes together</a></li>
<li><a class="reference internal" href="#angle-of-bank">Angle of bank</a></li>
<li><a class="reference internal" href="#moving-vertices-of-existing-shape">Moving vertices of existing Shape</a></li>
<li><a class="reference internal" href="#slow-animation">Slow animation</a><ul>
<li><a class="reference internal" href="#slow-on-non-raspberry-pi-machine">Slow on non-raspberry pi machine</a></li>
<li><a class="reference internal" href="#unresponsive-mouse-movement">unresponsive mouse movement</a></li>
</ul>
</li>
<li><a class="reference internal" href="#permission-denied">Permission denied</a></li>
<li><a class="reference internal" href="#full-screen">Full Screen</a></li>
<li><a class="reference internal" href="#post-processing">Post processing</a><ul>
<li><a class="reference internal" href="#postprocess-class">PostProcess class</a></li>
<li><a class="reference internal" href="#is-it-possible-to-access-the-postprocess-image-as-a-numpy-array">Is it possible to access the PostProcess image as a numpy array</a></li>
<li><a class="reference internal" href="#python-v-shader-unif-arrays">python v. shader unif arrays</a></li>
</ul>
</li>
<li><a class="reference internal" href="#blend-shaders">Blend shaders</a></li>
<li><a class="reference internal" href="#points">Points</a></li>
<li><a class="reference internal" href="#lines">Lines</a></li>
<li><a class="reference internal" href="#using-numpy-arrays-for-textures">Using numpy arrays for Textures</a></li>
<li><a class="reference internal" href="#assigning-different-textures-to-vertex-groups">Assigning different Textures to vertex groups</a></li>
<li><a class="reference internal" href="#without-pil-pillow">Without PIL (Pillow)</a></li>
<li><a class="reference internal" href="#minimal-sd-card">Minimal SD card</a></li>
<li><a class="reference internal" href="#pypy">pypy</a></li>
<li><a class="reference internal" href="#diy-environments">DIY environments</a><ul>
<li><a class="reference internal" href="#cube">Cube</a></li>
<li><a class="reference internal" href="#sphere">Sphere</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pickling">pickling</a></li>
<li><a class="reference internal" href="#strings">Strings</a><ul>
<li><a class="reference internal" href="#quick-change">quick change</a></li>
<li><a class="reference internal" href="#fixedstring">FixedString</a></li>
<li><a class="reference internal" href="#pointtext">PointText</a></li>
<li><a class="reference internal" href="#shadow">Shadow</a></li>
</ul>
</li>
<li><a class="reference internal" href="#normal-map-generation">Normal Map generation</a></li>
<li><a class="reference internal" href="#texture-animation">Texture animation</a></li>
<li><a class="reference internal" href="#profiling">Profiling</a></li>
<li><a class="reference internal" href="#desktop-or-laptop">Desktop or laptop</a></li>
<li><a class="reference internal" href="#android">Android</a></li>
<li><a class="reference internal" href="#targetting">Targetting</a><ul>
<li><a class="reference internal" href="#identify-what-s-in-front-of-the-camera">Identify what&#8217;s in front of the Camera</a></li>
<li><a class="reference internal" href="#bullets">Bullets</a></li>
<li><a class="reference internal" href="#laser-sight">Laser sight</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="ReadMe.html"
                        title="previous chapter">Introduction to pi3d</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="GPUexplain.html"
                        title="next chapter">3D Graphics Explanation</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/FAQ.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="GPUexplain.html" title="3D Graphics Explanation"
             >next</a> |</li>
        <li class="right" >
          <a href="ReadMe.html" title="Introduction to pi3d"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">pi3d 2.21 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2012-2017, The pi3d team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.4.8.
    </div>
  </body>
</html>