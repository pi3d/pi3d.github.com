
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>pi3d.shape.Building &#8212; pi3d 2.42 documentation</title>
    <link rel="stylesheet" href="../../../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../_static/language_data.js"></script>
    
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">pi3d 2.42 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" accesskey="U">Module code</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for pi3d.shape.Building</h1><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">absolute_import</span><span class="p">,</span> <span class="n">division</span><span class="p">,</span> <span class="n">print_function</span><span class="p">,</span> <span class="n">unicode_literals</span>

<span class="c1"># Silo project using pi3d module</span>
<span class="c1"># =====================================</span>
<span class="c1"># Copyright (c) 2012-2013 Richard Urwin</span>
<span class="c1"># All rights reserved.</span>
<span class="c1">#</span>
<span class="c1"># Redistribution and use in source and binary forms, with or without modification,</span>
<span class="c1"># are permitted provided that the following conditions are met:</span>
<span class="c1">#</span>
<span class="c1">#  * Redistributions of source code must retain the above copyright notice, this</span>
<span class="c1">#   list of conditions and the following disclaimer.</span>
<span class="c1">#  * Redistributions in binary form must reproduce the above copyright notice,</span>
<span class="c1">#   this list of conditions and the following disclaimer in the documentation</span>
<span class="c1">#   and/or other materials provided with the distribution.</span>
<span class="c1">#</span>
<span class="c1"># THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot; AND</span>
<span class="c1"># ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED</span>
<span class="c1"># WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE</span>
<span class="c1"># DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE</span>
<span class="c1"># FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL</span>
<span class="c1"># DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR</span>
<span class="c1"># SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER</span>
<span class="c1"># CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,</span>
<span class="c1"># OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE</span>
<span class="c1"># OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<span class="c1">#</span>
<span class="c1"># The above license is the 2-clause BSD license, which is compatible with both</span>
<span class="c1"># version 2 and 3 of the GPL. (Unlike versions 2 and 3 of the GPL ;-)</span>
<span class="c1"># http://www.gnu.org/licenses/license-list.html</span>
<span class="c1">#</span>
<span class="c1"># I aim to make all infrastructure of the Silo project open and free, although the</span>
<span class="c1"># finished game may contain none-free or otherwise restricted elements such as level maps.</span>
<span class="c1">#</span>
<span class="c1"># Based on code in the Forest Walk example</span>
<span class="c1"># Copyright (c) 2012 - Tim Skillman</span>
<span class="c1"># Version 0.04 - 20Jul12</span>
<span class="c1">#</span>
<span class="c1"># This example does not reflect the finished pi3d module in any way whatsoever!</span>
<span class="c1"># It merely aims to demonstrate a working concept in simplfying 3D programming on the Pi</span>
<span class="kn">import</span> <span class="nn">os.path</span>

<span class="kn">import</span> <span class="nn">math</span><span class="o">,</span> <span class="nn">random</span><span class="o">,</span> <span class="nn">sys</span>
<span class="kn">from</span> <span class="nn">six_mod.moves</span> <span class="k">import</span> <span class="nb">filter</span>

<span class="c1"># NB PIL must be available to use Building</span>
<span class="kn">from</span> <span class="nn">PIL</span> <span class="k">import</span> <span class="n">ImageOps</span><span class="p">,</span> <span class="n">ImageDraw</span><span class="p">,</span> <span class="n">Image</span>

<span class="kn">from</span> <span class="nn">pi3d.shape.MergeShape</span> <span class="k">import</span> <span class="n">MergeShape</span>
<span class="kn">from</span> <span class="nn">pi3d.shape.Cuboid</span> <span class="k">import</span> <span class="n">Cuboid</span>
<span class="kn">from</span> <span class="nn">pi3d.shape.Plane</span> <span class="k">import</span> <span class="n">Plane</span>
<span class="kn">from</span> <span class="nn">pi3d.Shape</span> <span class="k">import</span> <span class="n">Shape</span>
<span class="kn">from</span> <span class="nn">pi3d.Buffer</span> <span class="k">import</span> <span class="n">Buffer</span>
<span class="kn">from</span> <span class="nn">pi3d.Texture</span> <span class="k">import</span> <span class="n">Texture</span>
<span class="kn">import</span> <span class="nn">logging</span>

<span class="n">LOGGER</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="n">rads</span> <span class="o">=</span> <span class="mf">0.017453292512</span> <span class="c1"># degrees to radians</span>

<div class="viewcode-block" id="xyz"><a class="viewcode-back" href="../../../pi3d.shape.html#pi3d.shape.Building.xyz">[docs]</a><span class="k">class</span> <span class="nc">xyz</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  Encapsulates a 3D point-type triple.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">z</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Constructor</span>
<span class="sd">    Can be initialised either with one of these or by with three things that can be cast to floats.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">xyz</span><span class="p">):</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">x</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">y</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">z</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">z</span><span class="p">)</span></div>

<span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="k">return</span> <span class="s2">&quot;(</span><span class="si">{0}</span><span class="s2">, </span><span class="si">{1}</span><span class="s2">, </span><span class="si">{2}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">)</span>


<div class="viewcode-block" id="Size"><a class="viewcode-back" href="../../../pi3d.shape.html#pi3d.shape.Building.Size">[docs]</a><span class="k">class</span> <span class="nc">Size</span><span class="p">(</span><span class="n">xyz</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  Encapsulates a 3D size.</span>
<span class="sd">  Works together with Position to provide intelligent typing. A position plus a</span>
<span class="sd">  size is a position, whereas a position minus a position is a size.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">z</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">Size</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">Position</span><span class="p">):</span>
      <span class="k">return</span> <span class="n">Position</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span> <span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">z</span> <span class="o">+</span> <span class="n">a</span><span class="o">.</span><span class="n">z</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">Size</span><span class="p">):</span>
      <span class="k">return</span> <span class="n">Size</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span> <span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">z</span> <span class="o">+</span> <span class="n">a</span><span class="o">.</span><span class="n">z</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="k">raise</span> <span class="n">TypeException</span>

  <span class="k">def</span> <span class="nf">__sub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">a</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">Position</span><span class="p">):</span>
      <span class="k">return</span> <span class="n">Position</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">z</span> <span class="o">-</span> <span class="n">a</span><span class="o">.</span><span class="n">z</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">Size</span><span class="p">):</span>
      <span class="k">return</span> <span class="n">Size</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">z</span> <span class="o">-</span> <span class="n">a</span><span class="o">.</span><span class="n">z</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="k">raise</span> <span class="ne">TypeError</span>

  <span class="k">def</span> <span class="nf">__div__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">Size</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">/</span> <span class="n">a</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">/</span> <span class="n">a</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">z</span> <span class="o">/</span> <span class="n">a</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">__truediv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__div__</span><span class="p">(</span><span class="n">a</span><span class="p">)</span></div>


<div class="viewcode-block" id="Position"><a class="viewcode-back" href="../../../pi3d.shape.html#pi3d.shape.Building.Position">[docs]</a><span class="k">class</span> <span class="nc">Position</span><span class="p">(</span><span class="n">xyz</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  Encapsulates a 3D position.</span>
<span class="sd">  Works together with Size to provide intelligent typing. A position plus a</span>
<span class="sd">  size is a position, whereas a position minus a position is a size.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">z</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">Position</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">Size</span><span class="p">):</span>
      <span class="k">return</span> <span class="n">Position</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span> <span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">z</span> <span class="o">+</span> <span class="n">a</span><span class="o">.</span><span class="n">z</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">Position</span><span class="p">):</span>
      <span class="k">return</span> <span class="n">Size</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span> <span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">z</span> <span class="o">+</span> <span class="n">a</span><span class="o">.</span><span class="n">z</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="k">raise</span> <span class="n">TypeException</span>

  <span class="k">def</span> <span class="nf">__sub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">a</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">Size</span><span class="p">):</span>
      <span class="k">return</span> <span class="n">Position</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">z</span> <span class="o">-</span> <span class="n">a</span><span class="o">.</span><span class="n">z</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">Position</span><span class="p">):</span>
      <span class="k">return</span> <span class="n">Size</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">z</span> <span class="o">-</span> <span class="n">a</span><span class="o">.</span><span class="n">z</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="k">raise</span> <span class="ne">TypeError</span>

<div class="viewcode-block" id="Position.setvalue"><a class="viewcode-back" href="../../../pi3d.shape.html#pi3d.shape.Building.Position.setvalue">[docs]</a>  <span class="k">def</span> <span class="nf">setvalue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">Position</span><span class="p">):</span> <span class="k">raise</span> <span class="ne">TypeError</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">x</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">y</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">z</span></div></div>

<span class="k">def</span> <span class="nf">_overlap</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">w1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">w2</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  A utility function for testing for overlap on a single axis. Returns true</span>
<span class="sd">  if a line w1 above and below point x1 overlaps a line w2 above and below point x2.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="k">if</span> <span class="n">x1</span><span class="o">+</span><span class="n">w1</span> <span class="o">&lt;</span> <span class="n">x2</span><span class="o">-</span><span class="n">w2</span><span class="p">:</span> <span class="k">return</span> <span class="kc">False</span>
  <span class="k">if</span> <span class="n">x1</span><span class="o">-</span><span class="n">w1</span> <span class="o">&gt;</span> <span class="n">x2</span><span class="o">+</span><span class="n">w2</span><span class="p">:</span> <span class="k">return</span> <span class="kc">False</span>

  <span class="k">return</span> <span class="kc">True</span>

<div class="viewcode-block" id="ObjectCuboid"><a class="viewcode-back" href="../../../pi3d.shape.html#pi3d.shape.Building.ObjectCuboid">[docs]</a><span class="k">class</span> <span class="nc">ObjectCuboid</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  An ObjectCuboid has a size and position (of its centre) and a bulk.</span>
<span class="sd">  The size is its extent beyond the centre on the three axes, the position is the position of its centre.</span>
<span class="sd">  Note that this is different from the size of an ObjectCuboid. The bulk</span>
<span class="sd">  is an aura around it that the auras of other objects can not enter. The bulk can be zero.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">bulk</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Constructor</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">Size</span><span class="p">):</span> <span class="k">raise</span> <span class="ne">TypeError</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">Position</span><span class="p">):</span> <span class="k">raise</span> <span class="ne">TypeError</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">s</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">position</span> <span class="o">=</span> <span class="n">p</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">bulk</span> <span class="o">=</span> <span class="n">bulk</span>

<div class="viewcode-block" id="ObjectCuboid.x"><a class="viewcode-back" href="../../../pi3d.shape.html#pi3d.shape.Building.ObjectCuboid.x">[docs]</a>  <span class="k">def</span> <span class="nf">x</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the x coordinate of the centre of this object</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">position</span><span class="o">.</span><span class="n">x</span></div>

<div class="viewcode-block" id="ObjectCuboid.y"><a class="viewcode-back" href="../../../pi3d.shape.html#pi3d.shape.Building.ObjectCuboid.y">[docs]</a>  <span class="k">def</span> <span class="nf">y</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the x coordinate of the centre of this object</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">position</span><span class="o">.</span><span class="n">y</span></div>

<div class="viewcode-block" id="ObjectCuboid.top_y"><a class="viewcode-back" href="../../../pi3d.shape.html#pi3d.shape.Building.ObjectCuboid.top_y">[docs]</a>  <span class="k">def</span> <span class="nf">top_y</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Returns the y coordinate of the top of this object</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">position</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">bulk</span></div>

<div class="viewcode-block" id="ObjectCuboid.bottom_y"><a class="viewcode-back" href="../../../pi3d.shape.html#pi3d.shape.Building.ObjectCuboid.bottom_y">[docs]</a>  <span class="k">def</span> <span class="nf">bottom_y</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Returns the y coordinate of the top of this object</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">position</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">bulk</span></div>

<div class="viewcode-block" id="ObjectCuboid.z"><a class="viewcode-back" href="../../../pi3d.shape.html#pi3d.shape.Building.ObjectCuboid.z">[docs]</a>  <span class="k">def</span> <span class="nf">z</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the x coordinate of the centre of this object</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">position</span><span class="o">.</span><span class="n">z</span></div>

<div class="viewcode-block" id="ObjectCuboid.w"><a class="viewcode-back" href="../../../pi3d.shape.html#pi3d.shape.Building.ObjectCuboid.w">[docs]</a>  <span class="k">def</span> <span class="nf">w</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns size of this object along the x axis -- its width</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="o">.</span><span class="n">x</span></div>

<div class="viewcode-block" id="ObjectCuboid.h"><a class="viewcode-back" href="../../../pi3d.shape.html#pi3d.shape.Building.ObjectCuboid.h">[docs]</a>  <span class="k">def</span> <span class="nf">h</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns size of this object along the y axis -- its height</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="o">.</span><span class="n">y</span></div>

<div class="viewcode-block" id="ObjectCuboid.d"><a class="viewcode-back" href="../../../pi3d.shape.html#pi3d.shape.Building.ObjectCuboid.d">[docs]</a>  <span class="k">def</span> <span class="nf">d</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns size of this object along the z axis -- its depth</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="o">.</span><span class="n">z</span></div>

<div class="viewcode-block" id="ObjectCuboid.move"><a class="viewcode-back" href="../../../pi3d.shape.html#pi3d.shape.Building.ObjectCuboid.move">[docs]</a>  <span class="k">def</span> <span class="nf">move</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Moves this object to the given position.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">position</span><span class="o">.</span><span class="n">setvalue</span><span class="p">(</span><span class="n">p</span><span class="p">)</span></div>

<div class="viewcode-block" id="ObjectCuboid.Overlaps"><a class="viewcode-back" href="../../../pi3d.shape.html#pi3d.shape.Building.ObjectCuboid.Overlaps">[docs]</a>  <span class="k">def</span> <span class="nf">Overlaps</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">o</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns true if the current ObjectCuboid overlaps the given ObjectCuboid.</span>
<span class="sd">    If the pos argument is specified then it is used as the position of the</span>
<span class="sd">    given ObjectCuboid instead of its actual position.</span>

<span class="sd">    Clear as mud?</span>

<span class="sd">    Without a pos argument: &quot;does object o overlap me?&quot;</span>
<span class="sd">    With a pos argument: &quot;would object o overlap me if it was at position &#39;pos&#39;?&quot;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">pos</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="n">pos</span> <span class="o">=</span> <span class="n">o</span><span class="o">.</span><span class="n">position</span>
    <span class="k">return</span> <span class="n">_overlap</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">position</span><span class="o">.</span><span class="n">x</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">bulk</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="o">.</span><span class="n">x</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">bulk</span><span class="p">,</span> <span class="n">pos</span><span class="o">.</span><span class="n">x</span><span class="o">-</span><span class="n">o</span><span class="o">.</span><span class="n">bulk</span><span class="p">,</span> <span class="n">o</span><span class="o">.</span><span class="n">size</span><span class="o">.</span><span class="n">x</span><span class="o">+</span><span class="n">o</span><span class="o">.</span><span class="n">bulk</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span> <span class="ow">and</span> \
      <span class="n">_overlap</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">position</span><span class="o">.</span><span class="n">y</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">bulk</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="o">.</span><span class="n">y</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">bulk</span><span class="p">,</span> <span class="n">pos</span><span class="o">.</span><span class="n">y</span><span class="o">-</span><span class="n">o</span><span class="o">.</span><span class="n">bulk</span><span class="p">,</span> <span class="n">o</span><span class="o">.</span><span class="n">size</span><span class="o">.</span><span class="n">y</span><span class="o">+</span><span class="n">o</span><span class="o">.</span><span class="n">bulk</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span> <span class="ow">and</span> \
      <span class="n">_overlap</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">position</span><span class="o">.</span><span class="n">z</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">bulk</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="o">.</span><span class="n">z</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">bulk</span><span class="p">,</span> <span class="n">pos</span><span class="o">.</span><span class="n">z</span><span class="o">-</span><span class="n">o</span><span class="o">.</span><span class="n">bulk</span><span class="p">,</span> <span class="n">o</span><span class="o">.</span><span class="n">size</span><span class="o">.</span><span class="n">z</span><span class="o">+</span><span class="n">o</span><span class="o">.</span><span class="n">bulk</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="SolidObject"><a class="viewcode-back" href="../../../pi3d.shape.html#pi3d.shape.Building.SolidObject">[docs]</a><span class="k">class</span> <span class="nc">SolidObject</span><span class="p">(</span><span class="n">ObjectCuboid</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  A solid object is one that the avatar can not walk through. It has a size, a position and a bulk.</span>
<span class="sd">  The size is its total size on the three axes, the position is the position of its centre.</span>
<span class="sd">  The bulk is the aura around it into which the avatar&#39;s aura is not allowed to enter. A zero bulk works fine.</span>

<span class="sd">  Each solid object can have an optional model associated with it. Each SolidObject created is added to a</span>
<span class="sd">  list of SolidObjects. All the models of all the objects in the list can be drawn with a single method call (drawall).</span>
<span class="sd">  If a solid object does not have an associated model then drawall() does not attempt to draw it. That</span>
<span class="sd">  applies to the avatar and to any objects that are part of merged shapes for example.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="n">objectlist</span> <span class="o">=</span> <span class="p">[]</span>

  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="n">p</span><span class="p">,</span> <span class="n">bulk</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Constructor</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">SolidObject</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">s</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">bulk</span><span class="p">)</span>
    <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">objectlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">details</span> <span class="o">=</span> <span class="kc">None</span>

<div class="viewcode-block" id="SolidObject.remove"><a class="viewcode-back" href="../../../pi3d.shape.html#pi3d.shape.Building.SolidObject.remove">[docs]</a>  <span class="k">def</span> <span class="nf">remove</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
      <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">objectlist</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
      <span class="n">LOGGER</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Tried to remove </span><span class="si">%s</span><span class="s1"> twice.&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="SolidObject.CollisionList"><a class="viewcode-back" href="../../../pi3d.shape.html#pi3d.shape.Building.SolidObject.CollisionList">[docs]</a>  <span class="k">def</span> <span class="nf">CollisionList</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a list of the objects that would overlap with the current oject,</span>
<span class="sd">    if the current object was at the given position. (With the exception of the current</span>
<span class="sd">    oject of course.)</span>
<span class="sd">    This can be used for any moving object to ensure that its proposed new position is available,</span>
<span class="sd">    or maybe to determine when a missile should explode and what it should destroy.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">Position</span><span class="p">):</span> <span class="k">raise</span> <span class="ne">TypeError</span>
    <span class="n">r</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">Overlaps</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">p</span><span class="p">),</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">objectlist</span><span class="p">))</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">r</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="k">return</span> <span class="n">r</span></div>

<div class="viewcode-block" id="SolidObject.setmodel"><a class="viewcode-back" href="../../../pi3d.shape.html#pi3d.shape.Building.SolidObject.setmodel">[docs]</a>  <span class="k">def</span> <span class="nf">setmodel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">details</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Sets the associated model and the details with which to draw it. If the model is set</span>
<span class="sd">    then drawall() will draw this object. If it isn&#39;t, it wont.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">model</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">details</span> <span class="o">=</span> <span class="n">details</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">set_draw_details</span><span class="p">(</span><span class="n">details</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">details</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">details</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">details</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">details</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">details</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span></div>

<div class="viewcode-block" id="SolidObject.drawall"><a class="viewcode-back" href="../../../pi3d.shape.html#pi3d.shape.Building.SolidObject.drawall">[docs]</a>  <span class="nd">@classmethod</span>
  <span class="k">def</span> <span class="nf">drawall</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Draw all solid objects to which models (and detailss) have been associated.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">objectlist</span><span class="p">:</span>
      <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">model</span><span class="p">:</span>
        <span class="n">x</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span></div></div>

<div class="viewcode-block" id="createMyCuboid"><a class="viewcode-back" href="../../../pi3d.shape.html#pi3d.shape.Building.createMyCuboid">[docs]</a><span class="k">class</span> <span class="nc">createMyCuboid</span><span class="p">(</span><span class="n">Cuboid</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A bodge because my cuboids appear to be out of position with respect to my collision</span>
<span class="sd">    system. Fortunately it does not seem to happen with planes. Probably my fault.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">w</span><span class="p">,</span><span class="n">h</span><span class="p">,</span><span class="n">d</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span><span class="n">z</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">rx</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span><span class="n">ry</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span><span class="n">rz</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">cx</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span><span class="n">cy</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span><span class="n">cz</span><span class="o">=</span><span class="mf">0.0</span><span class="p">):</span>
      <span class="n">fact</span> <span class="o">=</span> <span class="mi">0</span>
      <span class="k">if</span> <span class="n">w</span> <span class="o">&gt;</span> <span class="n">fact</span><span class="p">:</span>
        <span class="n">fact</span> <span class="o">=</span> <span class="n">w</span>
      <span class="k">if</span> <span class="n">h</span> <span class="o">&gt;</span> <span class="n">fact</span><span class="p">:</span>
        <span class="n">fact</span> <span class="o">=</span> <span class="n">h</span>
      <span class="k">if</span> <span class="n">d</span> <span class="o">&gt;</span> <span class="n">fact</span><span class="p">:</span>
        <span class="n">fact</span> <span class="o">=</span> <span class="n">d</span>
      <span class="nb">super</span><span class="p">(</span><span class="n">createMyCuboid</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">w</span><span class="o">=</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="o">=</span><span class="n">h</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="n">d</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="o">+</span><span class="mf">0.125</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="n">z</span><span class="o">-</span><span class="mf">1.125</span><span class="p">,</span>
        <span class="n">rx</span><span class="o">=</span><span class="n">rx</span><span class="p">,</span> <span class="n">ry</span><span class="o">=</span><span class="n">ry</span><span class="p">,</span> <span class="n">rz</span><span class="o">=</span><span class="n">rz</span><span class="p">,</span> <span class="n">cx</span><span class="o">=</span><span class="n">cx</span><span class="p">,</span> <span class="n">cy</span><span class="o">=</span><span class="n">cy</span><span class="p">,</span> <span class="n">cz</span><span class="o">=</span><span class="n">cz</span><span class="p">,</span> <span class="n">tw</span><span class="o">=</span><span class="n">w</span> <span class="o">/</span> <span class="n">fact</span><span class="p">,</span> <span class="n">th</span><span class="o">=</span><span class="n">h</span> <span class="o">/</span> <span class="n">fact</span><span class="p">,</span> <span class="n">td</span><span class="o">=</span><span class="n">d</span> <span class="o">/</span> <span class="n">fact</span><span class="p">)</span></div>

<span class="n">wallnum</span><span class="o">=</span><span class="mi">0</span>
<div class="viewcode-block" id="corridor"><a class="viewcode-back" href="../../../pi3d.shape.html#pi3d.shape.Building.corridor">[docs]</a><span class="k">def</span> <span class="nf">corridor</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">z</span><span class="p">,</span> <span class="n">emap</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">details</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">walls</span><span class="o">=</span><span class="s2">&quot;ns&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;wall&quot;</span><span class="p">,</span> <span class="n">mergeshape</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  Creates a cell consisting of optional north, south, east and west walls and an optional ceiling.</span>
<span class="sd">  The north and south walls are parallel with the x axis, with north being more positive. The east and</span>
<span class="sd">  west walls are parallel with the z axis, with east being more positive.</span>
<span class="sd">  The cell is centred at (x,y,z). The cell is &quot;width&quot; along the z axis, (so north and south walls are that far apart,)</span>
<span class="sd">  &quot;length&quot; along the x axis, and &quot;height&quot; high. All walls and ceiling is a cuboid, 1 unit thick. There is no floor.</span>

<span class="sd">  Use this function when having the walls as planes is a problem, such as when their zero thinkness is visible.</span>
<span class="sd">  Otherwise corridor_planes() is more efficient.</span>

<span class="sd">  Which walls to create are specified by the string argument &quot;walls&quot;. This should contain the letters n,e,s,w to draw the</span>
<span class="sd">  corresponding wall, or &quot;o&quot; (for open) if no ceiling is required.</span>
<span class="sd">  For example a N-S corridor section would use &quot;ew&quot;, and a simple corner in the SE with no roof would be &quot;seo&quot;</span>

<span class="sd">  If mergeshape is None then the resulting objects are drawn with SolidObject.drawall(), if mergeshape is set then the</span>
<span class="sd">  objects are added to it and SolidObject.drawall() will not draw it.</span>

<span class="sd">  The objects are named with the given name argument as a prefix and a globally incrementing number as the suffix.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="k">global</span> <span class="n">wallnum</span>
  <span class="n">n</span> <span class="o">=</span> <span class="n">z</span> <span class="o">+</span> <span class="n">width</span> <span class="o">/</span> <span class="mi">2</span>
  <span class="n">s</span> <span class="o">=</span> <span class="n">z</span> <span class="o">-</span> <span class="n">width</span> <span class="o">/</span> <span class="mi">2</span>
  <span class="n">e</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">length</span> <span class="o">/</span> <span class="mi">2</span>
  <span class="n">w</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="n">length</span> <span class="o">/</span> <span class="mi">2</span>

  <span class="n">solid_objects</span> <span class="o">=</span> <span class="p">[]</span>

  <span class="k">if</span> <span class="s2">&quot;n&quot;</span> <span class="ow">in</span> <span class="n">walls</span><span class="p">:</span>
    <span class="c1"># TODO: abstract out the mostly-duplicate code in these cases...</span>
    <span class="n">nwall</span> <span class="o">=</span> <span class="n">SolidObject</span><span class="p">(</span><span class="n">name</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">wallnum</span><span class="p">),</span>
                        <span class="n">Size</span><span class="p">(</span><span class="n">length</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                        <span class="n">Position</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">emap</span><span class="o">.</span><span class="n">calcHeight</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span> <span class="o">+</span> <span class="n">height</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">n</span><span class="o">-</span><span class="mf">0.5</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">solid_objects</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nwall</span><span class="p">)</span>
    <span class="n">nwallmodel</span> <span class="o">=</span> <span class="n">createMyCuboid</span><span class="p">(</span><span class="n">nwall</span><span class="o">.</span><span class="n">w</span><span class="p">()</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="n">nwall</span><span class="o">.</span><span class="n">h</span><span class="p">()</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="n">nwall</span><span class="o">.</span><span class="n">d</span><span class="p">()</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span>
          <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">wallnum</span><span class="p">),</span>
          <span class="n">x</span><span class="o">=</span><span class="n">nwall</span><span class="o">.</span><span class="n">x</span><span class="p">(),</span><span class="n">y</span><span class="o">=</span><span class="n">nwall</span><span class="o">.</span><span class="n">y</span><span class="p">(),</span><span class="n">z</span><span class="o">=</span><span class="n">nwall</span><span class="o">.</span><span class="n">z</span><span class="p">(),</span>
          <span class="n">rx</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">ry</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">rz</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">cx</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">cy</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">cz</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">mergeshape</span><span class="p">:</span>
      <span class="n">mergeshape</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">nwallmodel</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">nwall</span><span class="o">.</span><span class="n">setmodel</span><span class="p">(</span><span class="n">nwallmodel</span><span class="p">,</span> <span class="n">details</span><span class="p">)</span>


    <span class="n">wallnum</span> <span class="o">+=</span> <span class="mi">1</span>

  <span class="k">if</span> <span class="s2">&quot;s&quot;</span> <span class="ow">in</span> <span class="n">walls</span><span class="p">:</span>
    <span class="n">swall</span> <span class="o">=</span> <span class="n">SolidObject</span><span class="p">(</span><span class="n">name</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">wallnum</span><span class="p">),</span> <span class="n">Size</span><span class="p">(</span><span class="n">length</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">Position</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">emap</span><span class="o">.</span><span class="n">calcHeight</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span><span class="o">+</span><span class="n">height</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">s</span><span class="o">+</span><span class="mf">0.5</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">solid_objects</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">swall</span><span class="p">)</span>
    <span class="n">swallmodel</span> <span class="o">=</span> <span class="n">createMyCuboid</span><span class="p">(</span><span class="n">swall</span><span class="o">.</span><span class="n">w</span><span class="p">()</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span> <span class="n">swall</span><span class="o">.</span><span class="n">h</span><span class="p">()</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span> <span class="n">swall</span><span class="o">.</span><span class="n">d</span><span class="p">()</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span>
                                <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">wallnum</span><span class="p">),</span>
                                <span class="n">x</span><span class="o">=</span><span class="n">swall</span><span class="o">.</span><span class="n">x</span><span class="p">(),</span> <span class="n">y</span><span class="o">=</span><span class="n">swall</span><span class="o">.</span><span class="n">y</span><span class="p">(),</span> <span class="n">z</span><span class="o">=</span><span class="n">swall</span><span class="o">.</span><span class="n">z</span><span class="p">(),</span>
                                <span class="n">rx</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">ry</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">rz</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">cx</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span><span class="n">cy</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">cz</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">mergeshape</span><span class="p">:</span>
      <span class="n">mergeshape</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">swallmodel</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">swall</span><span class="o">.</span><span class="n">setmodel</span><span class="p">(</span><span class="n">swallmodel</span><span class="p">,</span> <span class="n">details</span><span class="p">)</span>

    <span class="n">wallnum</span> <span class="o">+=</span> <span class="mi">1</span>

  <span class="k">if</span> <span class="s2">&quot;e&quot;</span> <span class="ow">in</span> <span class="n">walls</span><span class="p">:</span>
    <span class="n">ewall</span> <span class="o">=</span> <span class="n">SolidObject</span><span class="p">(</span><span class="n">name</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">wallnum</span><span class="p">),</span> <span class="n">Size</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">width</span><span class="p">),</span> <span class="n">Position</span><span class="p">(</span><span class="n">e</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">emap</span><span class="o">.</span><span class="n">calcHeight</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span><span class="o">+</span><span class="n">height</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">z</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">solid_objects</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ewall</span><span class="p">)</span>
    <span class="n">ewallmodel</span> <span class="o">=</span> <span class="n">createMyCuboid</span><span class="p">(</span><span class="n">ewall</span><span class="o">.</span><span class="n">w</span><span class="p">()</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span> <span class="n">ewall</span><span class="o">.</span><span class="n">h</span><span class="p">()</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span> <span class="n">ewall</span><span class="o">.</span><span class="n">d</span><span class="p">()</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span>
          <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">wallnum</span><span class="p">),</span>
          <span class="n">x</span><span class="o">=</span><span class="n">ewall</span><span class="o">.</span><span class="n">x</span><span class="p">(),</span> <span class="n">y</span><span class="o">=</span><span class="n">ewall</span><span class="o">.</span><span class="n">y</span><span class="p">(),</span> <span class="n">z</span><span class="o">=</span><span class="n">ewall</span><span class="o">.</span><span class="n">z</span><span class="p">(),</span>
          <span class="n">rx</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">ry</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">rz</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">cx</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">cy</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">cz</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">mergeshape</span><span class="p">:</span>
      <span class="n">mergeshape</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">ewallmodel</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">ewall</span><span class="o">.</span><span class="n">setmodel</span><span class="p">(</span><span class="n">ewallmodel</span><span class="p">,</span> <span class="n">details</span><span class="p">)</span>

    <span class="n">wallnum</span> <span class="o">+=</span> <span class="mi">1</span>

  <span class="k">if</span> <span class="s2">&quot;w&quot;</span> <span class="ow">in</span> <span class="n">walls</span><span class="p">:</span>
    <span class="n">wwall</span> <span class="o">=</span> <span class="n">SolidObject</span><span class="p">(</span><span class="n">name</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">wallnum</span><span class="p">),</span> <span class="n">Size</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">width</span><span class="p">),</span> <span class="n">Position</span><span class="p">(</span><span class="n">w</span><span class="o">+</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">emap</span><span class="o">.</span><span class="n">calcHeight</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span><span class="o">+</span><span class="n">height</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">z</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">solid_objects</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">wwall</span><span class="p">)</span>
    <span class="n">wwallmodel</span> <span class="o">=</span> <span class="n">createMyCuboid</span><span class="p">(</span><span class="n">wwall</span><span class="o">.</span><span class="n">w</span><span class="p">()</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span> <span class="n">wwall</span><span class="o">.</span><span class="n">h</span><span class="p">()</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span> <span class="n">wwall</span><span class="o">.</span><span class="n">d</span><span class="p">()</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span>
          <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">wallnum</span><span class="p">),</span>
          <span class="n">x</span><span class="o">=</span><span class="n">wwall</span><span class="o">.</span><span class="n">x</span><span class="p">(),</span> <span class="n">y</span><span class="o">=</span><span class="n">wwall</span><span class="o">.</span><span class="n">y</span><span class="p">(),</span> <span class="n">z</span><span class="o">=</span><span class="n">wwall</span><span class="o">.</span><span class="n">z</span><span class="p">(),</span>
          <span class="n">rx</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">ry</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">rz</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">cx</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">cy</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">cz</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">mergeshape</span><span class="p">:</span>
      <span class="n">mergeshape</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">wwallmodel</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">wwall</span><span class="o">.</span><span class="n">setmodel</span><span class="p">(</span><span class="n">wwallmodel</span><span class="p">,</span> <span class="n">details</span><span class="p">)</span>
    <span class="n">wallnum</span> <span class="o">+=</span> <span class="mi">1</span>

  <span class="k">if</span> <span class="s2">&quot;o&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">walls</span><span class="p">:</span>
    <span class="n">ceiling</span> <span class="o">=</span> <span class="n">SolidObject</span><span class="p">(</span><span class="n">name</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">wallnum</span><span class="p">),</span> <span class="n">Size</span><span class="p">(</span><span class="n">length</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">width</span><span class="p">),</span> <span class="n">Position</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">emap</span><span class="o">.</span><span class="n">calcHeight</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span><span class="o">+</span><span class="n">height</span><span class="o">+</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">z</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">solid_objects</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ceiling</span><span class="p">)</span>
    <span class="n">ceilingmodel</span> <span class="o">=</span> <span class="n">createMyCuboid</span><span class="p">(</span><span class="n">ceiling</span><span class="o">.</span><span class="n">w</span><span class="p">()</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span> <span class="n">ceiling</span><span class="o">.</span><span class="n">h</span><span class="p">()</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span> <span class="n">ceiling</span><span class="o">.</span><span class="n">d</span><span class="p">()</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span>
          <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">wallnum</span><span class="p">),</span>
          <span class="n">x</span><span class="o">=</span><span class="n">ceiling</span><span class="o">.</span><span class="n">x</span><span class="p">(),</span> <span class="n">y</span><span class="o">=</span><span class="n">ceiling</span><span class="o">.</span><span class="n">y</span><span class="p">(),</span> <span class="n">z</span><span class="o">=</span><span class="n">ceiling</span><span class="o">.</span><span class="n">z</span><span class="p">(),</span>
          <span class="n">rx</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">ry</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">rz</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">cx</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">cy</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">cz</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">mergeshape</span><span class="p">:</span>
      <span class="n">mergeshape</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">ceilingmodel</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">ceiling</span><span class="o">.</span><span class="n">setmodel</span><span class="p">(</span><span class="n">ceilingmodel</span><span class="p">,</span> <span class="n">details</span><span class="p">)</span>

    <span class="n">wallnum</span> <span class="o">+=</span> <span class="mi">1</span>

  <span class="k">return</span> <span class="n">solid_objects</span></div>


<div class="viewcode-block" id="Building"><a class="viewcode-back" href="../../../pi3d.shape.html#pi3d.shape.Building.Building">[docs]</a><span class="k">class</span> <span class="nc">Building</span> <span class="p">(</span><span class="nb">object</span><span class="p">):</span>

  <span class="c1"># baseScheme : black is wall, white is corridor or room, there is one model</span>
  <span class="n">baseScheme</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;#models&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
          <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="kc">None</span><span class="p">):</span> <span class="p">[[</span><span class="s2">&quot;R&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">]],</span>
          <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="kc">None</span><span class="p">):</span> <span class="p">[[</span><span class="s2">&quot;R&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;C&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">]],</span>
          <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s2">&quot;edge&quot;</span><span class="p">):</span> <span class="p">[[</span><span class="s2">&quot;W&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;CE&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">]],</span>
          <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s2">&quot;edge&quot;</span><span class="p">):</span> <span class="p">[[</span><span class="s2">&quot;W&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;CE&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">]],</span>
          <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">):[[</span><span class="s2">&quot;W&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;CE&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]}</span>

  <span class="c1"># openSectionScheme: black is wall, white is corridor or room, grey has no ceiling, there is one model</span>
  <span class="n">openSectionScheme</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;#models&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
              <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="kc">None</span><span class="p">)</span> <span class="p">:</span> <span class="p">[[</span><span class="s2">&quot;R&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">]],</span>           <span class="c1"># black cell has a roof</span>
              <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="kc">None</span><span class="p">):[[</span><span class="s2">&quot;C&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;R&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">]],</span>      <span class="c1"># white cell has a ceiling and roof</span>
              <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s2">&quot;edge&quot;</span><span class="p">):[[</span><span class="s2">&quot;W&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;CE&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">]],</span>    <span class="c1"># black cell on the edge next to a black cell has a wall and ceiling edge</span>
              <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s2">&quot;edge&quot;</span><span class="p">):[[</span><span class="s2">&quot;W&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;CE&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">]],</span>    <span class="c1"># grey cell on the edge next to a black cell has a wall and ceiling edge</span>
              <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s2">&quot;edge&quot;</span><span class="p">):[[</span><span class="s2">&quot;W&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;CE&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">]],</span>    <span class="c1"># white cell on the edge next to a black cell has a wall and ceiling edge</span>
              <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s2">&quot;edge&quot;</span><span class="p">):[[</span><span class="s2">&quot;CE&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">]],</span>         <span class="c1"># white cell on the edge next to a white cell a ceiling edge</span>
              <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">):[[</span><span class="s2">&quot;W&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">]],</span>             <span class="c1"># white cell next to a black cell has a wall</span>
              <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">):[[</span><span class="s2">&quot;W&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;CE&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">]],</span>       <span class="c1"># grey cell next to a black cell has a wall and ceiling edge</span>
              <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">):[[</span><span class="s2">&quot;CE&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]</span> <span class="p">}</span>            <span class="c1"># grey cell next to a white cell has a ceiling edge</span>

  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mapfile</span><span class="p">,</span> <span class="n">xpos</span><span class="p">,</span> <span class="n">zpos</span><span class="p">,</span> <span class="n">emap</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">depth</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;building&quot;</span><span class="p">,</span> <span class="n">draw_details</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">yoff</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">scheme</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates a building at the given location. Each pixel of the image is one cell of the building</span>
<span class="sd">    If the cell is white then the cell is open, if it is black then it is wall. If it is grey</span>
<span class="sd">    then it is open and has no ceiling.</span>
<span class="sd">    The building is centred at xpos, zpos (which gets renamed herin to x,y to match the image coords)</span>
<span class="sd">    Each cell is width on the x axis and depth on the z axis, and the walls are height high on the y axis.</span>

<span class="sd">    The function returns a merged shape with the entire building in it.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">xpos</span> <span class="o">=</span> <span class="n">xpos</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">zpos</span> <span class="o">=</span> <span class="n">zpos</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="n">width</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">depth</span> <span class="o">=</span> <span class="n">depth</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">height</span> <span class="o">=</span> <span class="n">height</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">ceilingthickness</span> <span class="o">=</span> <span class="mf">1.0</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">walls</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">if</span> <span class="n">scheme</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">scheme</span> <span class="o">=</span> <span class="n">Building</span><span class="o">.</span><span class="n">baseScheme</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">scheme</span> <span class="o">=</span> <span class="n">scheme</span>

    <span class="c1"># We don&#39;t have to be rigorous here, this should only be a draw_details or an iterable of draw_details.</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">draw_details</span><span class="p">,</span> <span class="s2">&quot;__getitem__&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">draw_details</span><span class="p">,</span> <span class="s2">&quot;__iter__&quot;</span><span class="p">):</span>
      <span class="k">assert</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">draw_details</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">scheme</span><span class="p">[</span><span class="s2">&quot;#models&quot;</span><span class="p">])</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">details</span> <span class="o">=</span> <span class="n">draw_details</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">details</span> <span class="o">=</span> <span class="p">[</span><span class="n">draw_details</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scheme</span><span class="p">[</span><span class="s2">&quot;#models&quot;</span><span class="p">])]</span>
    <span class="c1"># having a method like this allows draw details to be set later</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">yoff</span> <span class="o">=</span> <span class="n">yoff</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="p">[</span><span class="n">MergeShape</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="o">+</span><span class="s2">&quot;.&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scheme</span><span class="p">[</span><span class="s2">&quot;#models&quot;</span><span class="p">])]</span>

    <span class="k">if</span> <span class="n">mapfile</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;/&#39;</span><span class="p">:</span>
      <span class="kn">import</span> <span class="nn">os</span>
      <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">p</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="n">mapfile</span><span class="p">):</span> <span class="c1"># this could theoretically get different files with same name</span>
          <span class="n">mapfile</span> <span class="o">=</span> <span class="n">p</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="n">mapfile</span>
          <span class="k">break</span>
    <span class="n">LOGGER</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Loading building map ...</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">mapfile</span><span class="p">)</span>

    <span class="n">im</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">mapfile</span><span class="p">)</span>
    <span class="n">im</span> <span class="o">=</span> <span class="n">ImageOps</span><span class="o">.</span><span class="n">invert</span><span class="p">(</span><span class="n">im</span><span class="p">)</span>
    <span class="n">ix</span><span class="p">,</span><span class="n">iy</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">size</span>

    <span class="n">LOGGER</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;image size </span><span class="si">%d</span><span class="s2">, </span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">)</span>

    <span class="n">startx</span> <span class="o">=</span> <span class="n">xpos</span> <span class="o">-</span> <span class="n">ix</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">width</span>
    <span class="n">starty</span> <span class="o">=</span> <span class="n">zpos</span> <span class="o">-</span> <span class="n">ix</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">depth</span>

    <span class="n">yoff</span> <span class="o">+=</span> <span class="n">emap</span><span class="o">.</span><span class="n">calcHeight</span><span class="p">(</span><span class="o">-</span><span class="n">xpos</span><span class="p">,</span><span class="o">-</span><span class="n">zpos</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">im</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;P&quot;</span><span class="p">:</span>
        <span class="n">im</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="s1">&#39;P&#39;</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="n">Image</span><span class="o">.</span><span class="n">ADAPTIVE</span><span class="p">)</span>
    <span class="n">im</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">FLIP_TOP_BOTTOM</span><span class="p">)</span>
    <span class="n">im</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">FLIP_LEFT_RIGHT</span><span class="p">)</span>
    <span class="n">pixels</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">iy</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
      <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">ix</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
          <span class="n">colour</span> <span class="o">=</span> <span class="n">pixels</span><span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">]</span>

          <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_executeScheme</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">startx</span><span class="p">,</span> <span class="n">starty</span><span class="p">,</span> <span class="p">(</span><span class="n">colour</span><span class="p">,</span> <span class="n">pixels</span><span class="p">[</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">y</span><span class="p">],</span> <span class="s2">&quot;edge&quot;</span><span class="p">),</span> <span class="n">wallfunc</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">west_wall</span><span class="p">,</span> <span class="n">ceilingedgefunc</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">west_edge</span><span class="p">,</span> <span class="n">ceilingfunc</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ceiling</span><span class="p">,</span> <span class="n">rooffunc</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">roof</span><span class="p">)</span>
          <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_executeScheme</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">startx</span><span class="p">,</span> <span class="n">starty</span><span class="p">,</span> <span class="p">(</span><span class="n">colour</span><span class="p">,</span> <span class="n">pixels</span><span class="p">[</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">y</span><span class="p">]),</span> <span class="n">wallfunc</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">west_wall</span><span class="p">,</span> <span class="n">ceilingedgefunc</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">west_edge</span><span class="p">,</span> <span class="n">ceilingfunc</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ceiling</span><span class="p">,</span> <span class="n">rooffunc</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">roof</span><span class="p">)</span>

          <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="n">ix</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_executeScheme</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">startx</span><span class="p">,</span> <span class="n">starty</span><span class="p">,</span> <span class="p">(</span><span class="n">colour</span><span class="p">,</span> <span class="n">pixels</span><span class="p">[</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">y</span><span class="p">],</span> <span class="s2">&quot;edge&quot;</span><span class="p">),</span> <span class="n">wallfunc</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">east_wall</span><span class="p">,</span> <span class="n">ceilingedgefunc</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">east_edge</span><span class="p">,</span> <span class="n">ceilingfunc</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ceiling</span><span class="p">,</span> <span class="n">rooffunc</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">roof</span><span class="p">)</span>
          <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_executeScheme</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">startx</span><span class="p">,</span> <span class="n">starty</span><span class="p">,</span> <span class="p">(</span><span class="n">colour</span><span class="p">,</span> <span class="n">pixels</span><span class="p">[</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">y</span><span class="p">]),</span> <span class="n">wallfunc</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">east_wall</span><span class="p">,</span> <span class="n">ceilingedgefunc</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">east_edge</span><span class="p">,</span> <span class="n">ceilingfunc</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ceiling</span><span class="p">,</span> <span class="n">rooffunc</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">roof</span><span class="p">)</span>

          <span class="k">if</span> <span class="n">y</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_executeScheme</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">startx</span><span class="p">,</span> <span class="n">starty</span><span class="p">,</span> <span class="p">(</span><span class="n">colour</span><span class="p">,</span> <span class="n">pixels</span><span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;edge&quot;</span><span class="p">),</span> <span class="n">wallfunc</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">south_wall</span><span class="p">,</span> <span class="n">ceilingedgefunc</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">south_edge</span><span class="p">,</span> <span class="n">ceilingfunc</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ceiling</span><span class="p">,</span> <span class="n">rooffunc</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">roof</span><span class="p">)</span>
          <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_executeScheme</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">startx</span><span class="p">,</span> <span class="n">starty</span><span class="p">,</span> <span class="p">(</span><span class="n">colour</span><span class="p">,</span> <span class="n">pixels</span><span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span> <span class="n">wallfunc</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">south_wall</span><span class="p">,</span> <span class="n">ceilingedgefunc</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">south_edge</span><span class="p">,</span> <span class="n">ceilingfunc</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ceiling</span><span class="p">,</span> <span class="n">rooffunc</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">roof</span><span class="p">)</span>

          <span class="k">if</span> <span class="n">y</span> <span class="o">==</span> <span class="n">iy</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_executeScheme</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">startx</span><span class="p">,</span> <span class="n">starty</span><span class="p">,</span> <span class="p">(</span><span class="n">colour</span><span class="p">,</span> <span class="n">pixels</span><span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;edge&quot;</span><span class="p">),</span> <span class="n">wallfunc</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">north_wall</span><span class="p">,</span> <span class="n">ceilingedgefunc</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">north_edge</span><span class="p">,</span> <span class="n">ceilingfunc</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ceiling</span><span class="p">,</span> <span class="n">rooffunc</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">roof</span><span class="p">)</span>
          <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_executeScheme</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">startx</span><span class="p">,</span> <span class="n">starty</span><span class="p">,</span> <span class="p">(</span><span class="n">colour</span><span class="p">,</span> <span class="n">pixels</span><span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">+</span><span class="mi">1</span><span class="p">]),</span> <span class="n">wallfunc</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">north_wall</span><span class="p">,</span> <span class="n">ceilingedgefunc</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">north_edge</span><span class="p">,</span> <span class="n">ceilingfunc</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ceiling</span><span class="p">,</span> <span class="n">rooffunc</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">roof</span><span class="p">)</span>

          <span class="bp">self</span><span class="o">.</span><span class="n">_executeScheme</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">startx</span><span class="p">,</span> <span class="n">starty</span><span class="p">,</span> <span class="p">(</span><span class="n">colour</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="n">wallfunc</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ceilingedgefunc</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ceilingfunc</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ceiling</span><span class="p">,</span> <span class="n">rooffunc</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">roof</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">set_draw_details</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">details</span><span class="p">)</span> <span class="c1"># after models created otherwise</span>
                                        <span class="c1"># details lost by merging</span>


<div class="viewcode-block" id="Building.remove_walls"><a class="viewcode-back" href="../../../pi3d.shape.html#pi3d.shape.Building.Building.remove_walls">[docs]</a>  <span class="k">def</span> <span class="nf">remove_walls</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">walls</span><span class="p">:</span>
      <span class="n">w</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">walls</span> <span class="o">=</span> <span class="p">[]</span></div>

<div class="viewcode-block" id="Building.drawAll"><a class="viewcode-back" href="../../../pi3d.shape.html#pi3d.shape.Building.Building.drawAll">[docs]</a>  <span class="k">def</span> <span class="nf">drawAll</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Draws all the models that comprise the building</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">)):</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span></div>

<div class="viewcode-block" id="Building.set_draw_details"><a class="viewcode-back" href="../../../pi3d.shape.html#pi3d.shape.Building.Building.set_draw_details">[docs]</a>  <span class="k">def</span> <span class="nf">set_draw_details</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">details</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Set the shader, textures, ntiles and reflection strength</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">)):</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">set_draw_details</span><span class="p">(</span><span class="n">details</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">details</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">details</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="n">details</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="mi">3</span><span class="p">],</span> <span class="n">details</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="mi">4</span><span class="p">],</span> <span class="n">details</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="mi">5</span><span class="p">])</span></div>

  <span class="k">def</span> <span class="nf">_executeScheme</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">startx</span><span class="p">,</span> <span class="n">starty</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">wallfunc</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ceilingedgefunc</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ceilingfunc</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rooffunc</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calls the functions defined for the given key in the scheme.</span>
<span class="sd">    Each operation consists of a string and a model index. If the string is W then a wall is created and added to the indexed model.</span>
<span class="sd">    If the string is CE then a ceiling edge is created and added to the indexed model.</span>
<span class="sd">    If the string is R then a roof is created and if C then a ceiling is created.</span>
<span class="sd">    The key has one of three forms:</span>
<span class="sd">    (n1, n2) The first number is the colour of the current cell.</span>
<span class="sd">      The second number is the colour of the adjacent cell (on the other side of the prospective wall.)</span>
<span class="sd">      This is used once per direction to create upto four walls (and ceiling edges).</span>
<span class="sd">    (n1, n2, &quot;edge&quot;) As (n1,n2), but the cell is on the edge of the building.</span>
<span class="sd">    (n, None) The number is the colour of the current cell. This is used once per cell to create the ceiling and roof.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">scheme</span><span class="p">:</span>
      <span class="k">for</span> <span class="n">op</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">scheme</span><span class="p">[</span><span class="n">key</span><span class="p">]:</span>
        <span class="k">if</span> <span class="n">op</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;W&quot;</span> <span class="ow">and</span> <span class="n">wallfunc</span><span class="p">:</span>
          <span class="n">wallfunc</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="o">+</span> <span class="n">startx</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">yoff</span><span class="p">,</span> <span class="n">y</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">depth</span> <span class="o">+</span> <span class="n">starty</span><span class="p">,</span>
               <span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">depth</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">height</span><span class="p">,</span>
               <span class="bp">self</span><span class="o">.</span><span class="n">details</span><span class="p">[</span><span class="n">op</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="n">mergeshape</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="n">op</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
        <span class="k">elif</span> <span class="n">op</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;C&quot;</span> <span class="ow">and</span> <span class="n">ceilingfunc</span><span class="p">:</span>
          <span class="n">ceilingfunc</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="o">+</span> <span class="n">startx</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">yoff</span><span class="p">,</span> <span class="n">y</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">depth</span> <span class="o">+</span> <span class="n">starty</span><span class="p">,</span>
               <span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">depth</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">height</span><span class="p">,</span>
               <span class="bp">self</span><span class="o">.</span><span class="n">details</span><span class="p">[</span><span class="n">op</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="n">mergeshape</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="n">op</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
        <span class="k">elif</span> <span class="n">op</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;R&quot;</span> <span class="ow">and</span> <span class="n">rooffunc</span><span class="p">:</span>
          <span class="n">rooffunc</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="o">+</span> <span class="n">startx</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">yoff</span><span class="p">,</span> <span class="n">y</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">depth</span> <span class="o">+</span> <span class="n">starty</span><span class="p">,</span>
               <span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">depth</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">height</span><span class="p">,</span>
               <span class="bp">self</span><span class="o">.</span><span class="n">details</span><span class="p">[</span><span class="n">op</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="n">mergeshape</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="n">op</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
        <span class="k">elif</span> <span class="n">op</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;CE&quot;</span> <span class="ow">and</span> <span class="n">ceilingedgefunc</span><span class="p">:</span>
          <span class="n">ceilingedgefunc</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="o">+</span> <span class="n">startx</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">yoff</span><span class="p">,</span> <span class="n">y</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">depth</span> <span class="o">+</span> <span class="n">starty</span><span class="p">,</span>
               <span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">depth</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">height</span><span class="p">,</span>
               <span class="bp">self</span><span class="o">.</span><span class="n">details</span><span class="p">[</span><span class="n">op</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="n">mergeshape</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">[</span><span class="n">op</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>

<div class="viewcode-block" id="Building.north_wall"><a class="viewcode-back" href="../../../pi3d.shape.html#pi3d.shape.Building.Building.north_wall">[docs]</a>  <span class="k">def</span> <span class="nf">north_wall</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">details</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;wall&quot;</span><span class="p">,</span> <span class="n">mergeshape</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates a cell consisting of optional north, south, east and west walls and an optional ceiling.</span>
<span class="sd">    The north and south walls are parallel with the x axis, with north being more positive. The east and</span>
<span class="sd">    west walls are parallel with the z axis, with east being more positive.</span>
<span class="sd">    The cell is centred at (x,y,z). The cell is &quot;width&quot; along the z axis, (so north and south walls are that far apart,)</span>
<span class="sd">    &quot;length&quot; along the x axis, and &quot;height&quot; high. Each wall is a plane, but the ceiling is a cuboid, 1 unit high. There is no floor.</span>

<span class="sd">    The resulting object is added to the given mergeshape</span>

<span class="sd">    The objects are named with the given name argument as a prefix and a globally incrementing number as the suffix.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">wallnum</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">z</span> <span class="o">+</span> <span class="n">width</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">z</span> <span class="o">-</span> <span class="n">width</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="n">e</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">length</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="n">w</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="n">length</span> <span class="o">/</span> <span class="mi">2</span>

    <span class="n">nwall</span> <span class="o">=</span> <span class="n">SolidObject</span><span class="p">(</span><span class="n">name</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">wallnum</span><span class="p">),</span> <span class="n">Size</span><span class="p">(</span><span class="n">length</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">Position</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="n">height</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">n</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">walls</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nwall</span><span class="p">)</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">Plane</span><span class="p">(</span><span class="n">w</span><span class="o">=</span><span class="n">nwall</span><span class="o">.</span><span class="n">w</span><span class="p">()</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span> <span class="n">h</span><span class="o">=</span><span class="n">nwall</span><span class="o">.</span><span class="n">h</span><span class="p">()</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">wallnum</span><span class="p">))</span>
    <span class="n">mergeshape</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">nwall</span><span class="o">.</span><span class="n">x</span><span class="p">(),</span> <span class="n">nwall</span><span class="o">.</span><span class="n">y</span><span class="p">(),</span> <span class="n">nwall</span><span class="o">.</span><span class="n">z</span><span class="p">())</span>


    <span class="n">wallnum</span> <span class="o">+=</span> <span class="mi">1</span></div>

<div class="viewcode-block" id="Building.north_edge"><a class="viewcode-back" href="../../../pi3d.shape.html#pi3d.shape.Building.Building.north_edge">[docs]</a>  <span class="k">def</span> <span class="nf">north_edge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">details</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;wall&quot;</span><span class="p">,</span> <span class="n">mergeshape</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates a cell consisting of optional north, south, east and west walls and an optional ceiling.</span>
<span class="sd">    The north and south walls are parallel with the x axis, with north being more positive. The east and</span>
<span class="sd">    west walls are parallel with the z axis, with east being more positive.</span>
<span class="sd">    The cell is centred at (x,y,z). The cell is &quot;width&quot; along the z axis, (so north and south walls are that far apart,)</span>
<span class="sd">    &quot;length&quot; along the x axis, and &quot;height&quot; high. Each wall is a plane, but the ceiling is a cuboid, 1 unit high. There is no floor.</span>

<span class="sd">    The resulting object is added to the given mergeshape</span>

<span class="sd">    The objects are named with the given name argument as a prefix and a globally incrementing number as the suffix.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">wallnum</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">z</span> <span class="o">+</span> <span class="n">width</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">z</span> <span class="o">-</span> <span class="n">width</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="n">e</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">length</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="n">w</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="n">length</span> <span class="o">/</span> <span class="mi">2</span>

    <span class="n">model</span> <span class="o">=</span> <span class="n">Plane</span><span class="p">(</span><span class="n">w</span><span class="o">=</span><span class="n">length</span><span class="p">,</span> <span class="n">h</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ceilingthickness</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">wallnum</span><span class="p">))</span>
    <span class="n">mergeshape</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">+</span><span class="n">height</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">ceilingthickness</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>

    <span class="n">wallnum</span> <span class="o">+=</span> <span class="mi">1</span></div>

<div class="viewcode-block" id="Building.south_wall"><a class="viewcode-back" href="../../../pi3d.shape.html#pi3d.shape.Building.Building.south_wall">[docs]</a>  <span class="k">def</span> <span class="nf">south_wall</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">details</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;wall&quot;</span><span class="p">,</span> <span class="n">mergeshape</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates a cell consisting of optional north, south, east and west walls and an optional ceiling.</span>
<span class="sd">    The north and south walls are parallel with the x axis, with north being more positive. The east and</span>
<span class="sd">    west walls are parallel with the z axis, with east being more positive.</span>
<span class="sd">    The cell is centred at (x,y,z). The cell is &quot;width&quot; along the z axis, (so north and south walls are that far apart,)</span>
<span class="sd">    &quot;length&quot; along the x axis, and &quot;height&quot; high. Each wall is a plane, but the ceiling is a cuboid, 1 unit high. There is no floor.</span>

<span class="sd">    The resulting object is added to the given mergeshape</span>

<span class="sd">    The objects are named with the given name argument as a prefix and a globally incrementing number as the suffix.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">wallnum</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">z</span> <span class="o">+</span> <span class="n">width</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">z</span> <span class="o">-</span> <span class="n">width</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="n">e</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">length</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="n">w</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="n">length</span> <span class="o">/</span> <span class="mi">2</span>

    <span class="n">swall</span> <span class="o">=</span> <span class="n">SolidObject</span><span class="p">(</span><span class="n">name</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">wallnum</span><span class="p">),</span> <span class="n">Size</span><span class="p">(</span><span class="n">length</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">Position</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">+</span><span class="n">height</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">s</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">walls</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">swall</span><span class="p">)</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">Plane</span><span class="p">(</span><span class="n">w</span><span class="o">=</span><span class="n">swall</span><span class="o">.</span><span class="n">w</span><span class="p">()</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span> <span class="n">h</span><span class="o">=</span><span class="n">swall</span><span class="o">.</span><span class="n">h</span><span class="p">()</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">wallnum</span><span class="p">))</span>
    <span class="n">mergeshape</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">swall</span><span class="o">.</span><span class="n">x</span><span class="p">(),</span><span class="n">swall</span><span class="o">.</span><span class="n">y</span><span class="p">(),</span><span class="n">swall</span><span class="o">.</span><span class="n">z</span><span class="p">(),</span> <span class="n">rx</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span><span class="n">ry</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span><span class="n">rz</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>

    <span class="n">wallnum</span> <span class="o">+=</span> <span class="mi">1</span></div>

<div class="viewcode-block" id="Building.south_edge"><a class="viewcode-back" href="../../../pi3d.shape.html#pi3d.shape.Building.Building.south_edge">[docs]</a>  <span class="k">def</span> <span class="nf">south_edge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">details</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;wall&quot;</span><span class="p">,</span> <span class="n">mergeshape</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates a cell consisting of optional north, south, east and west walls and an optional ceiling.</span>
<span class="sd">    The north and south walls are parallel with the x axis, with north being more positive. The east and</span>
<span class="sd">    west walls are parallel with the z axis, with east being more positive.</span>
<span class="sd">    The cell is centred at (x,y,z). The cell is &quot;width&quot; along the z axis, (so north and south walls are that far apart,)</span>
<span class="sd">    &quot;length&quot; along the x axis, and &quot;height&quot; high. Each wall is a plane, but the ceiling is a cuboid, 1 unit high. There is no floor.</span>

<span class="sd">    The resulting object is added to the given mergeshape</span>

<span class="sd">    The objects are named with the given name argument as a prefix and a globally incrementing number as the suffix.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">wallnum</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">z</span> <span class="o">+</span> <span class="n">width</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">z</span> <span class="o">-</span> <span class="n">width</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="n">e</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">length</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="n">w</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="n">length</span> <span class="o">/</span> <span class="mi">2</span>

    <span class="n">model</span> <span class="o">=</span> <span class="n">Plane</span><span class="p">(</span><span class="n">w</span><span class="o">=</span><span class="n">length</span><span class="p">,</span> <span class="n">h</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ceilingthickness</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">wallnum</span><span class="p">))</span>
    <span class="n">mergeshape</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">+</span><span class="n">height</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">ceilingthickness</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span><span class="n">s</span><span class="p">,</span> <span class="n">rx</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span><span class="n">ry</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span><span class="n">rz</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>

    <span class="n">wallnum</span> <span class="o">+=</span> <span class="mi">1</span></div>

<div class="viewcode-block" id="Building.east_wall"><a class="viewcode-back" href="../../../pi3d.shape.html#pi3d.shape.Building.Building.east_wall">[docs]</a>  <span class="k">def</span> <span class="nf">east_wall</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">details</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;wall&quot;</span><span class="p">,</span> <span class="n">mergeshape</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates a cell consisting of optional north, south, east and west walls and an optional ceiling.</span>
<span class="sd">    The north and south walls are parallel with the x axis, with north being more positive. The east and</span>
<span class="sd">    west walls are parallel with the z axis, with east being more positive.</span>
<span class="sd">    The cell is centred at (x,y,z). The cell is &quot;width&quot; along the z axis, (so north and south walls are that far apart,)</span>
<span class="sd">    &quot;length&quot; along the x axis, and &quot;height&quot; high. Each wall is a plane, but the ceiling is a cuboid, 1 unit high. There is no floor.</span>

<span class="sd">    The resulting object is added to the given mergeshape</span>

<span class="sd">    The objects are named with the given name argument as a prefix and a globally incrementing number as the suffix.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">wallnum</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">z</span> <span class="o">+</span> <span class="n">width</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">z</span> <span class="o">-</span> <span class="n">width</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="n">e</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">length</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="n">w</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="n">length</span> <span class="o">/</span> <span class="mi">2</span>

    <span class="n">ewall</span> <span class="o">=</span> <span class="n">SolidObject</span><span class="p">(</span><span class="n">name</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">wallnum</span><span class="p">),</span> <span class="n">Size</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">width</span><span class="p">),</span> <span class="n">Position</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">y</span><span class="o">+</span><span class="n">height</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">z</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">walls</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ewall</span><span class="p">)</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">Plane</span><span class="p">(</span><span class="n">w</span><span class="o">=</span><span class="n">ewall</span><span class="o">.</span><span class="n">d</span><span class="p">()</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span> <span class="n">h</span><span class="o">=</span><span class="n">ewall</span><span class="o">.</span><span class="n">h</span><span class="p">()</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">wallnum</span><span class="p">))</span>
    <span class="n">mergeshape</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">ewall</span><span class="o">.</span><span class="n">x</span><span class="p">(),</span><span class="n">ewall</span><span class="o">.</span><span class="n">y</span><span class="p">(),</span><span class="n">ewall</span><span class="o">.</span><span class="n">z</span><span class="p">(),</span> <span class="n">rx</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span><span class="n">ry</span><span class="o">=</span><span class="mf">90.0</span><span class="p">,</span><span class="n">rz</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>

    <span class="n">wallnum</span> <span class="o">+=</span> <span class="mi">1</span></div>

<div class="viewcode-block" id="Building.east_edge"><a class="viewcode-back" href="../../../pi3d.shape.html#pi3d.shape.Building.Building.east_edge">[docs]</a>  <span class="k">def</span> <span class="nf">east_edge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">details</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;wall&quot;</span><span class="p">,</span> <span class="n">mergeshape</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates a cell consisting of optional north, south, east and west walls and an optional ceiling.</span>
<span class="sd">    The north and south walls are parallel with the x axis, with north being more positive. The east and</span>
<span class="sd">    west walls are parallel with the z axis, with east being more positive.</span>
<span class="sd">    The cell is centred at (x,y,z). The cell is &quot;width&quot; along the z axis, (so north and south walls are that far apart,)</span>
<span class="sd">    &quot;length&quot; along the x axis, and &quot;height&quot; high. Each wall is a plane, but the ceiling is a cuboid, 1 unit high. There is no floor.</span>

<span class="sd">    The resulting object is added to the given mergeshape</span>

<span class="sd">    The objects are named with the given name argument as a prefix and a globally incrementing number as the suffix.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">wallnum</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">z</span> <span class="o">+</span> <span class="n">width</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">z</span> <span class="o">-</span> <span class="n">width</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="n">e</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">length</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="n">w</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="n">length</span> <span class="o">/</span> <span class="mi">2</span>

    <span class="n">model</span> <span class="o">=</span> <span class="n">Plane</span><span class="p">(</span><span class="n">w</span><span class="o">=</span><span class="n">width</span><span class="p">,</span> <span class="n">h</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ceilingthickness</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">wallnum</span><span class="p">))</span>
    <span class="n">mergeshape</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span><span class="n">y</span><span class="o">+</span><span class="n">height</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">ceilingthickness</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span><span class="n">z</span><span class="p">,</span> <span class="n">rx</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span><span class="n">ry</span><span class="o">=</span><span class="mf">90.0</span><span class="p">,</span><span class="n">rz</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>

    <span class="n">wallnum</span> <span class="o">+=</span> <span class="mi">1</span></div>

<div class="viewcode-block" id="Building.west_wall"><a class="viewcode-back" href="../../../pi3d.shape.html#pi3d.shape.Building.Building.west_wall">[docs]</a>  <span class="k">def</span> <span class="nf">west_wall</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">details</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;wall&quot;</span><span class="p">,</span> <span class="n">mergeshape</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates a cell consisting of optional north, south, east and west walls and an optional ceiling.</span>
<span class="sd">    The north and south walls are parallel with the x axis, with north being more positive. The east and</span>
<span class="sd">    west walls are parallel with the z axis, with east being more positive.</span>
<span class="sd">    The cell is centred at (x,y,z). The cell is &quot;width&quot; along the z axis, (so north and south walls are that far apart,)</span>
<span class="sd">    &quot;length&quot; along the x axis, and &quot;height&quot; high. Each wall is a plane, but the ceiling is a cuboid, 1 unit high. There is no floor.</span>

<span class="sd">    The resulting object is added to the given mergeshape</span>

<span class="sd">    The objects are named with the given name argument as a prefix and a globally incrementing number as the suffix.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">wallnum</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">z</span> <span class="o">+</span> <span class="n">width</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">z</span> <span class="o">-</span> <span class="n">width</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="n">e</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">length</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="n">w</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="n">length</span> <span class="o">/</span> <span class="mi">2</span>

    <span class="n">wwall</span> <span class="o">=</span> <span class="n">SolidObject</span><span class="p">(</span><span class="n">name</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">wallnum</span><span class="p">),</span> <span class="n">Size</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">width</span><span class="p">),</span> <span class="n">Position</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">y</span><span class="o">+</span><span class="n">height</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">z</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">walls</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">wwall</span><span class="p">)</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">Plane</span><span class="p">(</span><span class="n">w</span><span class="o">=</span><span class="n">wwall</span><span class="o">.</span><span class="n">d</span><span class="p">()</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span> <span class="n">h</span><span class="o">=</span><span class="n">wwall</span><span class="o">.</span><span class="n">h</span><span class="p">()</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">wallnum</span><span class="p">))</span>
    <span class="n">mergeshape</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">wwall</span><span class="o">.</span><span class="n">x</span><span class="p">(),</span><span class="n">wwall</span><span class="o">.</span><span class="n">y</span><span class="p">(),</span><span class="n">wwall</span><span class="o">.</span><span class="n">z</span><span class="p">(),</span><span class="n">rx</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span><span class="n">ry</span><span class="o">=</span><span class="mf">90.0</span><span class="p">,</span><span class="n">rz</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>

    <span class="n">wallnum</span> <span class="o">+=</span> <span class="mi">1</span></div>

<div class="viewcode-block" id="Building.west_edge"><a class="viewcode-back" href="../../../pi3d.shape.html#pi3d.shape.Building.Building.west_edge">[docs]</a>  <span class="k">def</span> <span class="nf">west_edge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">details</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;wall&quot;</span><span class="p">,</span> <span class="n">mergeshape</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates a cell consisting of optional north, south, east and west walls and an optional ceiling.</span>
<span class="sd">    The north and south walls are parallel with the x axis, with north being more positive. The east and</span>
<span class="sd">    west walls are parallel with the z axis, with east being more positive.</span>
<span class="sd">    The cell is centred at (x,y,z). The cell is &quot;width&quot; along the z axis, (so north and south walls are that far apart,)</span>
<span class="sd">    &quot;length&quot; along the x axis, and &quot;height&quot; high. Each wall is a plane, but the ceiling is a cuboid, 1 unit high. There is no floor.</span>

<span class="sd">    The resulting object is added to the given mergeshape</span>

<span class="sd">    The objects are named with the given name argument as a prefix and a globally incrementing number as the suffix.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">wallnum</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">z</span> <span class="o">+</span> <span class="n">width</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">z</span> <span class="o">-</span> <span class="n">width</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="n">e</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">length</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="n">w</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="n">length</span> <span class="o">/</span> <span class="mi">2</span>

    <span class="n">model</span> <span class="o">=</span> <span class="n">Plane</span><span class="p">(</span><span class="n">w</span><span class="o">=</span><span class="n">width</span><span class="p">,</span> <span class="n">h</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ceilingthickness</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">wallnum</span><span class="p">))</span>
    <span class="n">mergeshape</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span><span class="n">y</span><span class="o">+</span><span class="n">height</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">ceilingthickness</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">rx</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span><span class="n">ry</span><span class="o">=</span><span class="mf">90.0</span><span class="p">,</span><span class="n">rz</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>

    <span class="n">wallnum</span> <span class="o">+=</span> <span class="mi">1</span></div>

<div class="viewcode-block" id="Building.ceiling"><a class="viewcode-back" href="../../../pi3d.shape.html#pi3d.shape.Building.Building.ceiling">[docs]</a>  <span class="k">def</span> <span class="nf">ceiling</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">details</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;wall&quot;</span><span class="p">,</span> <span class="n">mergeshape</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">makeroof</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">makeceiling</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates a cell consisting of optional north, south, east and west walls and an optional ceiling.</span>
<span class="sd">    The north and south walls are parallel with the x axis, with north being more positive. The east and</span>
<span class="sd">    west walls are parallel with the z axis, with east being more positive.</span>
<span class="sd">    The cell is centred at (x,y,z). The cell is &quot;width&quot; along the z axis, (so north and south walls are that far apart,)</span>
<span class="sd">    &quot;length&quot; along the x axis, and &quot;height&quot; high. Each wall is a plane, but the ceiling is a cuboid, 1 unit high. There is no floor.</span>

<span class="sd">    The resulting object is added to the given mergeshape</span>

<span class="sd">    The objects are named with the given name argument as a prefix and a globally incrementing number as the suffix.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">wallnum</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">z</span> <span class="o">+</span> <span class="n">width</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">z</span> <span class="o">-</span> <span class="n">width</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="n">e</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">length</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="n">w</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="n">length</span> <span class="o">/</span> <span class="mi">2</span>

    <span class="n">ceilingmodel</span> <span class="o">=</span> <span class="n">Plane</span><span class="p">(</span><span class="n">w</span><span class="o">=</span><span class="n">length</span><span class="p">,</span> <span class="n">h</span><span class="o">=</span><span class="n">width</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">wallnum</span><span class="p">))</span>
    <span class="n">mergeshape</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">ceilingmodel</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">+</span><span class="n">height</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">rx</span><span class="o">=</span><span class="mf">90.0</span><span class="p">,</span><span class="n">ry</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span><span class="n">rz</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>

    <span class="n">wallnum</span> <span class="o">+=</span> <span class="mi">1</span></div>

<div class="viewcode-block" id="Building.roof"><a class="viewcode-back" href="../../../pi3d.shape.html#pi3d.shape.Building.Building.roof">[docs]</a>  <span class="k">def</span> <span class="nf">roof</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">details</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;wall&quot;</span><span class="p">,</span> <span class="n">mergeshape</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">makeroof</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">makeceiling</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates a cell consisting of optional north, south, east and west walls and an optional ceiling.</span>
<span class="sd">    The north and south walls are parallel with the x axis, with north being more positive. The east and</span>
<span class="sd">    west walls are parallel with the z axis, with east being more positive.</span>
<span class="sd">    The cell is centred at (x,y,z). The cell is &quot;width&quot; along the z axis, (so north and south walls are that far apart,)</span>
<span class="sd">    &quot;length&quot; along the x axis, and &quot;height&quot; high. Each wall is a plane, but the ceiling is a cuboid, 1 unit high. There is no floor.</span>

<span class="sd">    The objects are named with the given name argument as a prefix and a globally incrementing number as the suffix.</span>

<span class="sd">    The resulting objects are added to the given mergeshape</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">wallnum</span>

    <span class="n">roof</span> <span class="o">=</span> <span class="n">SolidObject</span><span class="p">(</span><span class="n">name</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">wallnum</span><span class="p">),</span> <span class="n">Size</span><span class="p">(</span><span class="n">length</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">width</span><span class="p">),</span> <span class="n">Position</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">+</span><span class="n">height</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">ceilingthickness</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">z</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">walls</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">roof</span><span class="p">)</span>
    <span class="n">roofmodel</span> <span class="o">=</span> <span class="n">Plane</span><span class="p">(</span><span class="n">w</span><span class="o">=</span><span class="n">length</span><span class="p">,</span> <span class="n">h</span><span class="o">=</span><span class="n">width</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">wallnum</span><span class="p">))</span>
    <span class="n">mergeshape</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">roofmodel</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">+</span><span class="n">height</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">ceilingthickness</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">rx</span><span class="o">=</span><span class="mf">90.0</span><span class="p">,</span><span class="n">ry</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span><span class="n">rz</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>

    <span class="n">wallnum</span> <span class="o">+=</span> <span class="mi">1</span></div></div>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">pi3d 2.42 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" >Module code</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2012-2021, The pi3d team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.5.
    </div>
  </body>
</html>